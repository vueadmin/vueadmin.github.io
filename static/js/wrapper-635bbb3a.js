var V=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var k=(e,t,n)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s=(e,t)=>{for(var n in t||(t={}))U.call(t,n)&&k(e,n,t[n]);if(I)for(var n of I(t))W.call(t,n)&&k(e,n,t[n]);return e},E=(e,t)=>J(e,Q(t));var y=(e,t,n)=>new Promise((o,i)=>{var d=r=>{try{p(n.next(r))}catch(u){i(u)}},_=r=>{try{p(n.throw(r))}catch(u){i(u)}},p=r=>r.done?o(r.value):Promise.resolve(r.value).then(d,_);p((n=n.apply(e,t)).next())});import{g as b}from"./storage-30948ac7.js";import{c as v,d as g,o as c,e as l,s as D,ag as S,u as a,aq as O,af as f,ar as w,as as G,at as P,E as h,au as q,av as B,G as z,F as A,a0 as m,aw as X,n as Y,l as M,ax as Z,ay as ee,az as $,q as te,g as C,a3 as T,w as oe,aA as ne,aB as L,aC as re,S as ae}from"./index-33bf1b3f.js";import{u as se,f as ie,a as ce}from"./index-8e3e5bf7.js";import{u as N}from"./useLifeHandler.hook-ee3c745c.js";import{u as x,C as ue}from"./chartEditStore-c8c28128.js";import"./SettingItem-fdaa927c.js";/* empty css                                                                   */import"./SettingItemBox-d4806ccf.js";import"./CollapseItem-d5358824.js";import"./icon-fbd9f779.js";import"./index.esm.min-6647f1cb.js";import"./http-2604e9e8.js";import"./lodash-66d03337.js";import"./plugin-c8bfa633.js";const F=(e,t)=>({zIndex:e.zIndex===-1?t+1:e.zIndex+t+1,left:`${e.x}px`,top:`${e.y}px`}),H=(e,t)=>({width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}),j=e=>({display:e.hide?"none":"block"}),K=e=>{const t={};return e&&e.overFlowHidden&&(t.overflow="hidden"),t},le=e=>{const t=e.selectColor?{background:e.background}:{background:`url(${e.backgroundImage}) center center / cover no-repeat !important`};return s({position:"relative",width:e.width?`${e.width||100}px`:"100%",height:e.height?`${e.height}px`:"100%"},t)};const de=g({__name:"index",props:{groupData:{type:Object,required:!0},themeSetting:{type:Object,required:!0},themeColor:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){return(t,n)=>(c(!0),l(A,null,D(e.groupData.groupList,o=>(c(),l("div",{class:S(["chart-item",a(O)(o.styles.animations)]),key:o.id,style:f(s(s(s(s(s(s({},a(F)(o.attr,e.groupIndex)),a(w)(o.styles)),a(G)(o.styles)),a(j)(o.status)),a(K)(o.preview)),a(P)(o.styles)))},[(c(),h(z(o.chartConfig.chartKey),q({id:o.id,chartConfig:o,themeSetting:e.themeSetting,themeColor:e.themeColor,style:s({},a(H)(o.attr))},B(a(N)(o))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}}),pe=v(de,[["__scopeId","data-v-3933053a"]]);const _e=g({__name:"index",setup(e){const{initDataPond:t,clearMittDataPondMap:n}=se(),o=x(),i=m(()=>o.editCanvasConfig.chartThemeSetting),d=m(()=>X(o.editCanvasConfig.chartCustomThemeColorInfo)[o.editCanvasConfig.chartThemeColor]);return n(),Y(()=>{t(o.requestGlobalConfig)}),(_,p)=>(c(!0),l(A,null,D(a(o).componentList,(r,u)=>(c(),l("div",{class:S(["chart-item",a(O)(r.styles.animations)]),key:r.id,style:f(s(s(s(s(s(s({},a(F)(r.attr,u)),a(w)(r.styles)),a(G)(r.styles)),a(j)(r.status)),a(K)(r.preview)),a(P)(r.styles)))},[r.isGroup?(c(),h(a(pe),{key:0,groupData:r,groupIndex:u,themeSetting:i.value,themeColor:d.value},null,8,["groupData","groupIndex","themeSetting","themeColor"])):(c(),h(z(r.chartConfig.chartKey),q({key:1,id:r.id,chartConfig:r,themeSetting:i.value,themeColor:d.value,style:s({},a(H)(r.attr))},B(a(N)(r))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}}),R=v(_e,[["__scopeId","data-v-5d390a24"]]),he=e=>{const t=M(!1),n=setInterval(()=>{if(window.$vue.component){clearInterval(n);const o=i=>{window.$vue.component(i.chartConfig.chartKey)||window.$vue.component(i.chartConfig.chartKey,ie(i.chartConfig))};e.componentList.forEach(i=>y(void 0,null,function*(){i.isGroup?i.groupList.forEach(d=>{o(d)}):o(i)})),t.value=!0}},200);return{show:t}},ge=e=>{const t=x();t.requestGlobalConfig=e[ue.REQUEST_GLOBAL_CONFIG]};const ye=g({__name:"suspenseIndex",setup(e){return y(this,null,function*(){let t,n;[t,n]=Z(()=>b()),yield t,n();const o=x();ee(`预览-${o.editCanvasConfig.projectName}`);const i=m(()=>s(s({},le(o.editCanvasConfig)),w(o.editCanvasConfig))),d=m(()=>{const u=o.editCanvasConfig.previewScaleType;return u===$.SCROLL_Y||u===$.SCROLL_X});ge(o);const{entityRef:_,previewRef:p}=ce(o),{show:r}=he(o);return(u,Ce)=>(c(),l("div",{class:S(`go-preview ${a(o).editCanvasConfig.previewScaleType}`)},[d.value?(c(),l("div",{key:0,ref_key:"entityRef",ref:_,class:"go-preview-entity"},[te("div",{ref_key:"previewRef",ref:p,class:"go-preview-scale"},[a(r)?(c(),l("div",{key:0,style:f(i.value)},[C(a(R))],4)):T("",!0)],512)],512)):(c(),l("div",{key:1,ref_key:"previewRef",ref:p,class:"go-preview-scale"},[a(r)?(c(),l("div",{key:0,style:f(i.value)},[C(a(R))],4)):T("",!0)],512))],2))})}}),fe=v(ye,[["__scopeId","data-v-9fd91fbe"]]),me=g({__name:"index",setup(e){return(t,n)=>(c(),h(ne,null,{default:oe(()=>[C(fe)]),_:1}))}}),Pe=g({__name:"wrapper",setup(e){let t=M(Date.now());return[L.JSON,L.CHART_TO_PREVIEW].forEach(n=>{window.opener&&window.opener.addEventListener(n,o=>y(this,null,function*(){const i=yield b();re(ae.GO_CHART_STORAGE_LIST,[E(s({},o.detail),{id:i.id})]),t.value=Date.now()}))}),(n,o)=>(c(),h(me,{key:a(t)}))}});export{Pe as default};

var k=(m,f,s)=>new Promise((F,o)=>{var c=n=>{try{_(s.next(n))}catch(d){o(d)}},C=n=>{try{_(s.throw(n))}catch(d){o(d)}},_=n=>n.done?F(n.value):Promise.resolve(n.value).then(c,C);_((s=s.apply(m,f)).next())});import{c as j,d as L,Z as H,l as T,aH as R,L as Q,r as u,o as O,B as P,w as t,g as e,q as A,h as r,t as g,u as a,b0 as Z,m as J,a0 as K,cl as W,co as X,e as Y,cM as z,aj as $,bd as ee}from"./index-bf5e9e89.js";import{i as te}from"./icon-7b13cf26.js";import{S as y}from"./SettingItem-23e91160.js";import{S}from"./SettingItemBox-44099fe1.js";import"./chartEditStore-68139809.js";import{R as ae,a as oe}from"./pondIndex.vue_vue_type_style_index_0_scoped_true_lang-90306f79.js";import{u as ue}from"./useTargetData.hook-773d641f.js";import"./index-34835e15.js";import"./EditorWorker-44e5efae.js";import"./editorWorker-09f50f3f.js";import{c as ne}from"./http-0c17ef5b.js";import{C as se}from"./index-d9f3a82a.js";/* empty css                                                                   */import"./plugin-d9d5359a.js";import"./components-5392f6c4.js";import"./fileTypeEnum-21359a08.js";const le={class:"go-pr-3"},re=r("—— "),ce=L({__name:"index",props:{modelShow:Boolean,targetData:Object,saveBtnText:String||null},emits:["update:modelShow","sendHandle"],setup(m,{emit:f}){const s=m,{chartConfig:F}=H(s.targetData),{requestContentType:o}=H(s.targetData.request),c=T(!1),C={[R.DEFAULT]:"普通请求",[R.SQL]:"SQL 请求"};Q(()=>s.modelShow,n=>{c.value=n},{immediate:!0});const _=()=>{f("update:modelShow",!1),f("sendHandle")};return(n,d)=>{const i=u("n-space"),v=u("n-scrollbar"),E=u("n-text"),D=u("n-tag"),w=u("n-button"),I=u("n-card"),B=u("n-modal");return O(),P(B,{class:"go-chart-data-request",show:c.value,"onUpdate:show":d[0]||(d[0]=h=>c.value=h),"mask-closable":!1,closeOnEsc:!1},{default:t(()=>[e(I,{bordered:!1,role:"dialog",size:"small","aria-modal":"true",style:{width:"1000px",height:"800px"}},{header:t(()=>[]),"header-extra":t(()=>[]),action:t(()=>[e(i,{justify:"space-between"},{default:t(()=>[A("div",null,[e(E,null,{default:t(()=>[r("「 "+g(a(F).categoryName)+" 」",1)]),_:1}),e(E,null,{default:t(()=>[re]),_:1}),e(D,{type:"primary",bordered:!1,style:{"border-radius":"5px"}},{default:t(()=>[r(g(C[a(o)]),1)]),_:1})]),e(w,{type:"primary",onClick:_},{default:t(()=>[r(g(m.saveBtnText||"保存 & 发送请求"),1)]),_:1})]),_:1})]),default:t(()=>[e(v,{style:{"max-height":"718px"}},{default:t(()=>[A("div",le,[e(i,{vertical:""},{default:t(()=>{var h;return[e(a(ae)),e(a(oe),{"target-data-request":(h=m.targetData)==null?void 0:h.request},null,8,["target-data-request"])]}),_:1})])]),_:1})]),_:1})]),_:1},8,["show"])}}}),de=j(ce,[["__scopeId","data-v-64d662be"]]);const ie={class:"go-chart-configurations-data-ajax"},_e={class:"go-absolute-center"},pe=r("编辑配置"),me=r(" 测试 "),fe=r(" 默认赋值给 dataset 字段 "),he=r(" 发送请求 "),ge=L({__name:"index",setup(m){Z(p=>({"7da624cc":a(h)}));const{HelpOutlineIcon:f,FlashIcon:s,PulseIcon:F}=te.ionicons5,{targetData:o,chartEditStore:c}=ue(),{requestOriginUrl:C,requestInterval:_,requestIntervalUnit:n}=H(c.getRequestGlobalConfig),d=J(),i=T(!1),v=T(!1),E=T(!1);let D=0,w;const I=()=>{v.value=!0},B=()=>k(this,null,function*(){var p;if((p=o.value)!=null&&p.request){i.value=!0;try{const l=yield ne($(o.value.request),$(c.getRequestGlobalConfig));if(i.value=!1,l){const{data:x}=l;!x&&!o.value.filter&&window.$message.warning("您的数据不符合默认格式，请配置过滤器！"),o.value.option.dataset=ee(x,l,o.value.filter),E.value=!0;return}window.$message.warning("没有拿到返回值，请检查接口！")}catch(l){console.error(l),i.value=!1,window.$message.warning("数据异常，请检查参数！")}}}),h=K(()=>d.getAppTheme);return W(()=>{var l;const p=(l=o.value)==null?void 0:l.filter;w!==p&&D&&(w=p,B()),D++}),X(()=>{w=null}),(p,l)=>{const x=u("n-tag"),q=u("n-input"),b=u("n-icon"),U=u("n-button"),G=u("n-card"),N=u("n-tooltip"),M=u("go-skeleton");return O(),Y("div",ie,[e(G,{class:"n-card-shallow"},{default:t(()=>[e(a(S),{name:"请求配置"},{default:t(()=>[e(a(y),{name:"类型"},{default:t(()=>[e(x,{bordered:!1,type:"primary",style:{"border-radius":"5px"}},{default:t(()=>[r(g(a(o).request.requestContentType===a(R).DEFAULT?"普通请求":"SQL请求"),1)]),_:1})]),_:1}),e(a(y),{name:"方式"},{default:t(()=>[e(q,{size:"small",placeholder:a(o).request.requestHttpType||"暂无",disabled:!0},null,8,["placeholder"])]),_:1}),e(a(y),{name:"组件间隔"},{default:t(()=>[e(q,{size:"small",placeholder:`${a(o).request.requestInterval||"暂无"}`,disabled:!0},{suffix:t(()=>[r(g(a(z)[a(o).request.requestIntervalUnit]),1)]),_:1},8,["placeholder"])]),_:1}),e(a(y),{name:"全局间隔（默认）"},{default:t(()=>[e(q,{size:"small",placeholder:`${a(_)||"暂无"} `,disabled:!0},{suffix:t(()=>[r(g(a(z)[a(n)]),1)]),_:1},8,["placeholder"])]),_:1})]),_:1}),e(a(S),{name:"源地址",alone:!0},{default:t(()=>[e(q,{size:"small",placeholder:a(C)||"暂无",disabled:!0},{prefix:t(()=>[e(b,{component:a(F)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),e(a(S),{name:"组件地址",alone:!0},{default:t(()=>[e(q,{size:"small",placeholder:a(o).request.requestUrl||"暂无",disabled:!0},{prefix:t(()=>[e(b,{component:a(s)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),A("div",{class:"edit-text",onClick:I},[A("div",_e,[e(U,{type:"primary",secondary:""},{default:t(()=>[pe]),_:1})])])]),_:1}),e(a(S),{alone:!0},{name:t(()=>[me,e(N,{trigger:"hover"},{trigger:t(()=>[e(b,{size:"21",depth:3},{default:t(()=>[e(a(f))]),_:1})]),default:t(()=>[fe]),_:1})]),default:t(()=>[e(U,{type:"primary",ghost:"",onClick:B},{icon:t(()=>[e(b,null,{default:t(()=>[e(a(s))]),_:1})]),default:t(()=>[he]),_:1})]),_:1}),e(a(se),{show:E.value&&!i.value,ajax:!0},null,8,["show"]),e(M,{load:i.value,repeat:3},null,8,["load"]),e(a(de),{modelShow:v.value,"onUpdate:modelShow":l[0]||(l[0]=V=>v.value=V),targetData:a(o),onSendHandle:B},null,8,["modelShow","targetData"])])}}}),Ue=j(ge,[["__scopeId","data-v-04550996"]]);export{Ue as default};

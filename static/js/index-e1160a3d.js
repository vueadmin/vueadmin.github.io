var E=(e,a,n)=>new Promise((c,s)=>{var i=l=>{try{d(n.next(l))}catch(p){s(p)}},_=l=>{try{d(n.throw(l))}catch(p){s(p)}},d=l=>l.done?c(l.value):Promise.resolve(l.value).then(i,_);d((n=n.apply(e,a)).next())});import{a as N,f as O,j as x,k as G}from"./index-63f16b81.js";import{d as w,j as $,J as T,bG as M,Q as U,o as f,c as g,bH as V,bI as R,bJ as z,bK as J,g as q,bL as Q,bM as Y,bN as j,bO as W,bP as X,a1 as Z,a as I,n as S,F as ee,q as te,b as v,u as b,a9 as L,w as k,a5 as ae,bQ as ne,aM as oe,s as se,x as re,ag as ce,h as ie}from"./index-20fb0306.js";import{u as le,b as de,f as P}from"./chartEditStore-eb4e0443.js";import{u as ue,a as A}from"./chartLayoutStore-b4f2137a.js";import{u as fe}from"./index-f3f87510.js";import{a as ge,b as _e,l as pe,g as me}from"./plugin-2033e7b2.js";import{c as y}from"./index-e3d67d15.js";import{i as he}from"./icon-cb727678.js";import"./SettingItem-11e342fe.js";/* empty css                                                                      */import"./SettingItemBox-6e9bb9c5.js";import"./CollapseItem.vue_vue_type_script_setup_true_lang-561b5bfa.js";import"./chart-169a825c.js";import"./index-2f0d3686.js";const Ce={class:"list-img",alt:"图表图片"},ve=w({__name:"index",props:{chartConfig:{type:Object,required:!0}},setup(e){const a=e,n=$(""),c=()=>E(this,null,function*(){n.value=yield N(a.chartConfig)});return T(()=>a.chartConfig.key,()=>c(),{immediate:!0}),(s,i)=>{const _=M("lazy");return U((f(),g("img",Ce,null,512)),[[_,n.value]])}}});var K=(e=>(e.PRIVATE="Private",e.SHARE="Share",e))(K||{});function be(e){var a=e==null?0:e.length;return a?e[a-1]:void 0}var ye=be;function Ee(e,a,n){var c=-1,s=e.length;a<0&&(a=-a>s?0:s+a),n=n>s?s:n,n<0&&(n+=s),s=a>n?0:n-a>>>0,a>>>=0;for(var i=Array(s);++c<s;)i[c]=e[c+a];return i}var ke=Ee,Se=V,De=ke;function Oe(e,a){return a.length<2?e:Se(e,De(a,0,-1))}var xe=Oe,Ie=R,Le=ye,Pe=xe,Ae=z;function we(e,a){return a=Ie(a,e),e=Pe(e,a),e==null||delete e[Ae(Le(a))]}var $e=we,Te=J;function Re(e){return Te(e)?void 0:e}var Ke=Re,Be=Q,Fe=X,He=$e,Ne=R,Ge=Y,Me=Ke,Ue=j,Ve=W,ze=1,Je=2,qe=4,Qe=Ue(function(e,a){var n={};if(e==null)return n;var c=!1;a=Be(a,function(i){return i=Ne(i,e),c||(c=i.length>1),i}),Ge(e,Ve(e),n),c&&(n=Fe(n,ze|Je|qe,Me));for(var s=a.length;s--;)He(n,a[s]);return n}),Ye=Qe;const je=q(Ye),We=e=>(se("data-v-31ce1dce"),e=e(),re(),e),Xe={class:"go-content-charts-item-animation-patch"},Ze=["onDragstart","onDragend","onDblclick","onClick"],et={class:"list-center go-flex-center go-transition",draggable:"true"},tt={key:0,class:"list-model"},at=["onClick"],nt=We(()=>S("span",null,"删除",-1)),ot=w({__name:"index",props:{menuOptions:{type:Array,default:()=>[]}},emits:["deletePhoto"],setup(e,{emit:a}){const n=le(),{TrashIcon:c}=he.ionicons5,s=ue(),i=$(),_=t=>!t.disabled&&t.package===de.PHOTOS&&t.category===K.PRIVATE,d=Z(()=>s.getChartType),l=(t,o)=>{o.disabled||(y(o.chartKey,O(o)),y(o.conKey,x(o)),t.dataTransfer.setData(ne.DRAG_KEY,oe(je(o,["image"]))),n.setEditCanvas(P.IS_CREATE,!0))},p=()=>{n.setEditCanvas(P.IS_CREATE,!1)},B=t=>{const o=t.category;if(!["Background","Rabbit","Dress"].includes(o))return!1;let m=!1,r=null;for(const C of n.componentList)if(C.chartConfig.category===o){m=!0,r=C;break}m&&r&&n.removeComponentList(r.id)},D=t=>E(this,null,function*(){if(B(t),!t.disabled)try{ge(),y(t.chartKey,O(t)),y(t.conKey,x(t));let o=yield G(t);t.redirectComponent&&(t.dataset&&(o.option.dataset=t.dataset),o.chartConfig.title=t.title,o.chartConfig.chartFrame=t.chartFrame),n.addComponentList(o,!1,!0),n.setTargetSelectChart(o.id);const u=t.category;["Background","Rabbit","Dress"].includes(u)&&n.setLock(),_e()}catch(o){pe(),window.$message.warning("图表正在研发中, 敬请期待...")}}),F=t=>{var o;(o=t==null?void 0:t.configEvents)==null||o.addHandle(t),D(t)},H=(t,o)=>{me({message:"是否删除此图片？",transformOrigin:"center",onPositiveCallback:()=>{const u=fe();a("deletePhoto",t,o),u.deletePhotos(t,o)}})};return T(()=>d.value,t=>{t===A.DOUBLE&&ce(()=>{i.value.classList.add("miniAnimation")})}),(t,o)=>{const u=I("n-icon"),m=I("n-button");return f(),g("div",Xe,[S("div",{ref_key:"contentChartsItemBoxRef",ref:i,class:ae(["go-content-charts-item-box",[b(d)===b(A).DOUBLE?"double":"single"]])},[(f(!0),g(ee,null,te(e.menuOptions,(r,C)=>(f(),g("div",{class:"item-box",key:r.title,draggable:"",onDragstart:h=>!r.disabled&&l(h,r),onDragend:h=>!r.disabled&&p,onDblclick:h=>D(r),onClick:h=>F(r)},[S("div",et,[v(b(ve),{class:"list-img",chartConfig:r},null,8,["chartConfig"])]),r.disabled?(f(),g("div",tt)):L("",!0),_(r)?(f(),g("div",{key:1,class:"list-tools go-transition",onClick:h=>H(r,C)},[v(m,{text:"",type:"default",color:"#ffffff"},{icon:k(()=>[v(u,null,{default:k(()=>[v(b(c))]),_:1})]),default:k(()=>[nt]),_:1})],8,at)):L("",!0)],40,Ze))),128))],2)])}}});const bt=ie(ot,[["__scopeId","data-v-31ce1dce"]]);export{bt as default};

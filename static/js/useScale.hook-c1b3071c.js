var W=Object.defineProperty;var m=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var y=(s,i,e)=>i in s?W(s,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[i]=e,x=(s,i)=>{for(var e in i||(i={}))L.call(i,e)&&y(s,e,i[e]);if(m)for(var e of m(i))$.call(i,e)&&y(s,e,i[e]);return s};import{a as E}from"./querySelectorAll-a1c431d2.js";import{ay as p,j as v,bq as b,m as S,aI as R,a2 as f}from"./index-20fb0306.js";const H=(s,i,e,n)=>{const o=s,w=i,t={width:1,height:1},c=parseFloat((o/w).toFixed(5)),r=()=>{const l=parseFloat((window.innerWidth/window.innerHeight).toFixed(5));e&&(l>c?(t.width=parseFloat((window.innerHeight*c/o).toFixed(5)),t.height=parseFloat((window.innerHeight/w).toFixed(5)),e.style.transform=`scale(${t.width}, ${t.height})`):(t.height=parseFloat((window.innerWidth/c/w).toFixed(5)),t.width=parseFloat((window.innerWidth/o).toFixed(5)),e.style.transform=`scale(${t.width}, ${t.height})`),n&&n(t))},a=p(()=>{r()},200);return{calcRate:r,windowResize:()=>{window.addEventListener("resize",a)},unWindowResize:()=>{window.removeEventListener("resize",a)}}},C=(s,i,e,n)=>{const o=s,w=i,t={width:1,height:1},c=parseFloat((o/w).toFixed(5)),r=()=>{e&&(t.height=parseFloat((window.innerWidth/c/w).toFixed(5)),t.width=parseFloat((window.innerWidth/o).toFixed(5)),e.style.transform=`scale(${t.width}, ${t.height})`,n&&n(t))},a=p(()=>{r()},200);return{calcRate:r,windowResize:()=>{window.addEventListener("resize",a)},unWindowResize:()=>{window.removeEventListener("resize",a)}}},P=(s,i,e,n)=>{const o=s,w=i,t={height:1,width:1},c=parseFloat((o/w).toFixed(5)),r=()=>{e&&(t.width=parseFloat((window.innerHeight*c/o).toFixed(5)),t.height=parseFloat((window.innerHeight/w).toFixed(5)),e.style.transform=`scale(${t.width}, ${t.height})`,n&&n(t))},a=p(()=>{r()},200);return{calcRate:r,windowResize:()=>{window.addEventListener("resize",a)},unWindowResize:()=>{window.removeEventListener("resize",a)}}},_=(s,i,e,n)=>{const o={width:1,height:1},w=()=>{e&&(o.width=parseFloat((window.innerWidth/s).toFixed(5)),o.height=parseFloat((window.innerHeight/i).toFixed(5)),e.style.transform=`scale(${o.width}, ${o.height})`,n&&n(o))},t=p(()=>{w()},200);return{calcRate:w,windowResize:()=>{window.addEventListener("resize",t)},unWindowResize:()=>{window.removeEventListener("resize",t)}}};function q(s,i,e,n){var o=n&&typeof n!="boolean"?n.capture:n;s.removeEventListener(i,e,o),e.__once&&s.removeEventListener(i,e.__once,o)}function T(s,i,e,n){return E(s,i,e,n),function(){q(s,i,e,n)}}const A="scale-value",U=s=>{const i=v(),e=v(),n=v(s.editCanvasConfig.width),o=v(s.editCanvasConfig.height),w=v({width:1,height:1});b(A,w);const t=r=>{addEventListener("wheel",a=>{var d,h;if((d=window==null?void 0:window.$KeyboardActive)!=null&&d.ctrl){a.preventDefault(),a.stopPropagation(),r();const z=((h=e.value)==null?void 0:h.style.transform).match(/scale\((\d+\.?\d*)*/)[1],g=document.querySelector(".go-preview"),F=document.querySelector(".go-preview-entity");if(g&&(g.style.overflow="unset",g.style.position="absolute"),F&&(F.style.overflow="unset"),a.wheelDelta>0){const u=parseFloat(Number(z).toFixed(2));e.value.style.transform=`scale(${u>5?5:u+.1})`}else{const u=parseFloat(Number(z).toFixed(2));e.value.style.transform=`scale(${u<.2?.2:u-.1})`}}},{passive:!1})},c=r=>{w.value=x({},r)};return S(()=>{switch(s.editCanvasConfig.previewScaleType){case R.FIT:(()=>{const{calcRate:r,windowResize:a,unWindowResize:d}=H(n.value,o.value,e.value,c);r(),a(),t(d),f(()=>{d()})})();break;case R.SCROLL_Y:(()=>{const{calcRate:r,windowResize:a,unWindowResize:d}=C(n.value,o.value,e.value,h=>{const l=i.value;l.style.width=`${n.value*h.width}px`,l.style.height=`${o.value*h.height}px`,c(h)});r(),a(),t(d),f(()=>{d()})})();break;case R.SCROLL_X:(()=>{const{calcRate:r,windowResize:a,unWindowResize:d}=P(n.value,o.value,e.value,h=>{const l=i.value;l.style.width=`${n.value*h.width}px`,l.style.height=`${o.value*h.height}px`,c(h)});r(),a(),t(d),f(()=>{d()})})();break;case R.FULL:(()=>{const{calcRate:r,windowResize:a,unWindowResize:d}=_(n.value,o.value,e.value,c);r(),a(),t(d),f(()=>{d()})})();break}}),{entityRef:i,previewRef:e,scaleRef:w}};export{A as S,T as l,U as u};

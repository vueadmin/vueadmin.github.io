var mn=Object.defineProperty,Cn=Object.defineProperties;var _n=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var wn=Object.prototype.hasOwnProperty,En=Object.prototype.propertyIsEnumerable;var Pe=(c,t,o)=>t in c?mn(c,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[t]=o,W=(c,t)=>{for(var o in t||(t={}))wn.call(t,o)&&Pe(c,o,t[o]);if(Te)for(var o of Te(t))En.call(t,o)&&Pe(c,o,t[o]);return c},bt=(c,t)=>Cn(c,_n(t));var ht=(c,t,o)=>new Promise((a,l)=>{var d=e=>{try{s(o.next(e))}catch(n){l(n)}},r=e=>{try{s(o.throw(e))}catch(n){l(n)}},s=e=>e.done?a(e.value):Promise.resolve(e.value).then(d,r);s((o=o.apply(c,t)).next())});import{n as Xt,a1 as Ge,b0 as yn,ak as T,cB as Ke,cC as Xe,cD as be,bb as ot,aX as jt,cA as Sn,aE as ae,cE as Q,al as Le,b3 as te,c as Ct,d as ft,b2 as Qt,m as qt,a0 as U,o as O,e as at,f as ve,F as Tt,s as Rt,ag as pt,af as it,u as E,a3 as Vt,q as G,aw as Qe,E as Z,w as F,G as St,aq as re,ar as $t,as as ie,at as qe,$ as Ve,p as ge,am as ke,L as mt,Z as pe,l as X,cF as Re,z as me,A as Ce,g as K,r as dt,Q as Bt,R as Ft,an as Je,I as Mn,X as xn,h as zt,M as ee,ch as ne,aN as Ot,aO as Ae,B as Ze,J as De,aB as Ht,W as kt,cG as je,aH as tn,ba as Oe,t as It,b7 as Tn,cH as Pn,b8 as Ie,bh as bn,x as Ln,S as kn}from"./index-4fcb3be9.js";import{u as _e,d as Rn}from"./index-88438035.js";import{u as ct,E as st,a as An,C as Dn,e as On}from"./chartEditStore-336cdf4e.js";import{d as we,f as en,c as nn,ai as In}from"./index-e84a9f75.js";import{a as on,b as ce,l as sn,g as Nn}from"./plugin-df5f6951.js";import{l as Mt}from"./lodash-d6021255.js";import{C as Un}from"./index-52de5cd1.js";import{u as an,C as le}from"./chartLayoutStore-d058c0b7.js";import{c as Ne}from"./components-f953741f.js";import{G as Bn}from"./index-d611183d.js";import{i as rn}from"./icon-d3fee87d.js";import{F as Ue}from"./fileTypeEnum-21359a08.js";import{r as Fn}from"./file-84751f49.js";import{u as Hn}from"./packagesStore-07f47bcb.js";import{h as cn}from"./http-f023be67.js";import"./SettingItem-70b897b1.js";/* empty css                                                                   */import"./SettingItemBox-c2b2739d.js";import"./CollapseItem-b5d39a24.js";import"./index.esm.min-a77e6deb.js";const Lt=ct(),$n=()=>{Xt(()=>{Lt.setEditCanvas(st.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Lt.setEditCanvas(st.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const c=Lt.listenerScale();Ge(()=>{Lt.setEditCanvas(st.EDIT_LAYOUT_DOM,null),Lt.setEditCanvas(st.EDIT_CONTENT_DOM,null),c()})})};var ue={},zn={get exports(){return ue},set exports(c){ue=c}};(function(c){(function(t){var o,a={},l={16:!1,18:!1,17:!1,91:!1},d="all",r={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},s={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},e=function(g){return s[g]||g.toUpperCase().charCodeAt(0)},n=[];for(o=1;o<20;o++)s["f"+o]=111+o;function i(g,w){for(var M=g.length;M--;)if(g[M]===w)return M;return-1}function u(g,w){if(g.length!=w.length)return!1;for(var M=0;M<g.length;M++)if(g[M]!==w[M])return!1;return!0}var h={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function f(g){for(o in l)l[o]=g[h[o]]}function v(g){var w,M,x,z,N,lt;if(w=g.keyCode,i(n,w)==-1&&n.push(w),(w==93||w==224)&&(w=91),w in l){l[w]=!0;for(x in r)r[x]==w&&(_[x]=!0);return}if(f(g),!!_.filter.call(this,g)&&w in a){for(lt=B(),z=0;z<a[w].length;z++)if(M=a[w][z],M.scope==lt||M.scope=="all"){N=M.mods.length>0;for(x in l)(!l[x]&&i(M.mods,+x)>-1||l[x]&&i(M.mods,+x)==-1)&&(N=!1);(M.mods.length==0&&!l[16]&&!l[18]&&!l[17]&&!l[91]||N)&&M.method(g,M)===!1&&(g.preventDefault?g.preventDefault():g.returnValue=!1,g.stopPropagation&&g.stopPropagation(),g.cancelBubble&&(g.cancelBubble=!0))}}}function p(g){var w=g.keyCode,M,x=i(n,w);if(x>=0&&n.splice(x,1),(w==93||w==224)&&(w=91),w in l){l[w]=!1;for(M in r)r[M]==w&&(_[M]=!1)}}function m(){for(o in l)l[o]=!1;for(o in r)_[o]=!1}function _(g,w,M){var x,z;x=S(g),M===void 0&&(M=w,w="all");for(var N=0;N<x.length;N++)z=[],g=x[N].split("+"),g.length>1&&(z=q(g),g=[g[g.length-1]]),g=g[0],g=e(g),g in a||(a[g]=[]),a[g].push({shortcut:x[N],scope:w,method:M,key:x[N],mods:z})}function P(g,w){var M,x,z=[],N,lt,I;for(M=S(g),lt=0;lt<M.length;lt++){if(x=M[lt].split("+"),x.length>1&&(z=q(x),g=x[x.length-1]),g=e(g),w===void 0&&(w=B()),!a[g])return;for(N=0;N<a[g].length;N++)I=a[g][N],I.scope===w&&u(I.mods,z)&&(a[g][N]={})}}function k(g){return typeof g=="string"&&(g=e(g)),i(n,g)!=-1}function y(){return n.slice(0)}function L(g){var w=(g.target||g.srcElement).tagName;return!(w=="INPUT"||w=="SELECT"||w=="TEXTAREA")}for(o in r)_[o]=!1;function A(g){d=g||"all"}function B(){return d||"all"}function H(g){var w,M,x;for(w in a)for(M=a[w],x=0;x<M.length;)M[x].scope===g?M.splice(x,1):x++}function S(g){var w;return g=g.replace(/\s/g,""),w=g.split(","),w[w.length-1]==""&&(w[w.length-2]+=","),w}function q(g){for(var w=g.slice(0,g.length-1),M=0;M<w.length;M++)w[M]=r[w[M]];return w}function b(g,w,M){g.addEventListener?g.addEventListener(w,M,!1):g.attachEvent&&g.attachEvent("on"+w,function(){M(window.event)})}b(document,"keydown",function(g){v(g)}),b(document,"keyup",p),b(window,"focus",m);var D=t.key;function R(){var g=t.key;return t.key=D,g}t.key=_,t.key.setScope=A,t.key.getScope=B,t.key.deleteScope=H,t.key.filter=L,t.key.isPressed=k,t.key.getPressedKeyCodes=y,t.key.noConflict=R,t.key.unbind=P,c.exports=_})(yn)})(zn);const tt=ue,et=ct(),rt=c=>`${Ke.CTRL}+${c}`,Nt=c=>`${Ke.SHIFT}+${c}`,V={[T.ARROW_UP]:rt("up"),[T.ARROW_RIGHT]:rt("right"),[T.ARROW_DOWN]:rt("down"),[T.ARROW_LEFT]:rt("left"),[T.COPY]:rt("c"),[T.CUT]:rt("x"),[T.PARSE]:rt("v"),[T.DELETE]:"delete",[T.BACK]:rt("z"),[T.FORWORD]:rt(Nt("z")),[T.GROUP]:rt("g"),[T.UN_GROUP]:rt(Nt("g")),[T.LOCK]:rt("l"),[T.UNLOCK]:rt(Nt("l")),[T.HIDE]:rt("h"),[T.SHOW]:rt(Nt("h"))},nt=c=>`${Xe.CTRL}+${c}`,Ut=c=>`${Xe.SHIFT}+${c}`,J={[T.ARROW_UP]:nt("arrowup"),[T.ARROW_RIGHT]:nt("arrowright"),[T.ARROW_DOWN]:nt("arrowdown"),[T.ARROW_LEFT]:nt("arrowleft"),[T.COPY]:nt("c"),[T.CUT]:nt("x"),[T.PARSE]:nt("v"),[T.DELETE]:nt("backspace"),[T.BACK]:nt("z"),[T.FORWORD]:nt(Ut("z")),[T.GROUP]:nt("g"),[T.UN_GROUP]:nt(Ut("g")),[T.LOCK]:nt("l"),[T.UNLOCK]:nt(Ut("l")),[T.HIDE]:nt("h"),[T.SHOW]:nt(Ut("h"))},Wn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],Yn=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],Gn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=c=>{const{keyCode:t}=c;if(t==32&&c.target==document.body&&c.preventDefault(),[17,32].includes(t)&&window.$KeyboardActive)switch(be(c.keyCode),t){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=c=>{const{keyCode:t}=c;if(t==32&&c.target==document.body&&c.preventDefault(),[17,32].includes(t)&&window.$KeyboardActive)switch(be(),t){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Kn=()=>{const t=(o,a)=>{switch(a){case o.up:tt(a,ot(()=>(et.setMove(T.ARROW_UP),!1),50));break;case o.right:tt(a,ot(()=>(et.setMove(T.ARROW_RIGHT),!1),50));break;case o.down:tt(a,ot(()=>(et.setMove(T.ARROW_DOWN),!1),50));break;case o.left:tt(a,ot(()=>(et.setMove(T.ARROW_LEFT),!1),50));break;case o.delete:tt(a,jt(()=>(et.removeComponentList(),!1),50));break;case o.copy:tt(a,jt(()=>(et.setCopy(),!1),50));break;case o.cut:tt(a,jt(()=>(et.setCut(),!1),50));break;case o.parse:tt(a,ot(()=>(et.setParse(),!1),50));break;case o.back:tt(a,ot(()=>(et.setBack(),!1),50));break;case o.forward:tt(a,ot(()=>(et.setForward(),!1),50));break;case o.group:tt(a,ot(()=>(et.setGroup(),!1),50));break;case o.unGroup:tt(a,ot(()=>(et.setUnGroup(),!1),50));break;case o.lock:tt(a,ot(()=>(et.setLock(),!1),50));break;case o.unLock:tt(a,ot(()=>(et.setUnLock(),!1),50));break;case o.hide:tt(a,ot(()=>(et.setHide(),!1),50));break;case o.show:tt(a,ot(()=>(et.setShow(),!1),50));break}};Wn.forEach(o=>{t(V,o)}),Yn.forEach(o=>{t(J,o)}),Gn()},C=ct(),{onClickOutSide:Be}=_e(),Xn=c=>ht(void 0,null,function*(){c.preventDefault();try{on();const t=c.dataTransfer.getData(Sn.DRAG_KEY);if(!t){ce();return}C.setEditCanvas(st.IS_CREATE,!1);const o=ae(t);let a=yield we(o);const l=["Backgrounds","Rabbits","Clothing","Informations","Other"];let d=0,r=0;switch(a.chartConfig.package){case"Backgrounds":d=0,r=382;break;case"Rabbits":d=382,r=0;break;case"Clothing":d=300,r=0;break;case"Jewelry":d=382,r=0;break;case"Decoration":d=618,r=382;break;case"Line":d=618,r=0;break;case"Informations":d=0,r=0;break;case"Other":d=0,r=0;break;default:d=c.offsetX-a.attr.w/2,r=c.offsetY-a.attr.h/2;break}Q(a,d,r),C.addComponentList(a,!1,!0),C.setTargetSelectChart(a.id),l.includes(a.chartConfig.package)&&C.setLock(!0,!0),ce()}catch(t){sn(),window.$message.warning("图表正在研发中, 敬请期待...")}}),Fe=c=>{c.preventDefault(),c.stopPropagation(),c.dataTransfer&&(c.dataTransfer.dropEffect="copy")},ln=(c,t)=>{if(t){C.setTargetSelectChart(t.id);return}C.setTargetSelectChart(void 0)},Qn=(c,t)=>{var n;if(c.which==2||(n=window.$KeyboardActive)!=null&&n.space)return;ln();const o=c.offsetX,a=c.offsetY,l=c.screenX,d=c.screenY,r=C.getEditCanvas.scale;C.setMousePosition(void 0,void 0,o,a);const s=Mt.throttle(i=>{C.setTargetSelectChart(),C.setEditCanvas(st.IS_SELECT,!0);const u=o+i.screenX-l,h=a+i.screenY-d;C.setMousePosition(u,h);const f={x1:0,y1:0,x2:0,y2:0};u>o&&h>a?(f.x1=o,f.y1=a,f.x2=Math.round(o+(i.screenX-l)/r),f.y2=Math.round(a+(i.screenY-d)/r)):u>o&&h<a?(f.x1=o,f.y1=Math.round(a-(d-i.screenY)/r),f.x2=Math.round(o+(i.screenX-l)/r),f.y2=a):u<o&&h>a?(f.x1=Math.round(o-(l-i.screenX)/r),f.y1=a,f.x2=o,f.y2=Math.round(a+(i.screenY-d)/r)):(f.x1=Math.round(o-(l-i.screenX)/r),f.y1=Math.round(a-(d-i.screenY)/r),f.x2=o,f.y2=a),C.getComponentList.forEach(v=>{if(!C.getTargetChart.selectId.includes(v.id)){const{x:p,y:m,w:_,h:P}=v.attr,k={x1:p,y1:m,x2:p+_,y2:m+P};k.x1-f.x1>=0&&k.y1-f.y1>=0&&k.x2-f.x2<=0&&k.y2-f.y2<=0&&!v.status.lock&&!v.status.hide&&C.setTargetSelectChart(v.id,!0)}})},30),e=()=>{s.cancel(),C.setEditCanvas(st.IS_SELECT,!1),C.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",e)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",e)},Ee=()=>({mouseClickHandle:(d,r)=>{var s;if(d.preventDefault(),d.stopPropagation(),!r.status.lock&&(s=window.$KeyboardActive)!=null&&s.ctrl)if(C.targetChart.selectId.includes(r.id)){const e=C.targetChart.selectId.filter(n=>n!==r.id);C.setTargetSelectChart(e)}else C.setTargetSelectChart(r.id,!0)},mousedownHandle:(d,r)=>{var _;if(d.preventDefault(),d.stopPropagation(),r.status.lock||(Be(),d.buttons===te.LEFT&&((_=window.$KeyboardActive)!=null&&_.ctrl)))return;const s=C.getTargetChart.selectId;if(d.buttons===te.RIGHT&&s.length>1&&s.includes(r.id)||(C.setTargetSelectChart(r.id),d.buttons===te.RIGHT))return;const e=C.getEditCanvas.scale,n=C.getEditCanvasConfig.width,i=C.getEditCanvasConfig.height,u=new Map;C.getTargetChart.selectId.forEach(P=>{const k=C.fetchTargetIndex(P);if(k!==-1){const{x:y,y:L,w:A,h:B}=Le(C.getComponentList[k]).attr;u.set(P,{x:y,y:L,w:A,h:B})}});const h=d.screenX,f=d.screenY;let v=[];C.getTargetChart.selectId.forEach(P=>{if(!u.has(P))return;const k=C.fetchTargetIndex(P);v.push(Mt.cloneDeep(C.getComponentList[k]))}),C.setMousePosition(void 0,void 0,h,f);const p=Mt.throttle(P=>{C.setEditCanvas(st.IS_DRAG,!0),C.setMousePosition(P.screenX,P.screenY);let k=(P.screenX-h)/e,y=(P.screenY-f)/e;C.getTargetChart.selectId.forEach(L=>{if(!u.has(L))return;const A=C.fetchTargetIndex(L),{x:B,y:H,w:S,h:q}=u.get(L),b=C.getComponentList[A];let D=Math.round(B+k),R=Math.round(H+y);const g=50;D=D<-S+g?-S+g:D,R=R<-q+g?-q+g:R,D=D>n-g?n-g:D,R=R>i-g?i-g:R,b&&(b.attr=Object.assign(b.attr,{x:D,y:R}))})},20),m=()=>{try{C.setMousePosition(0,0,0,0),C.setEditCanvas(st.IS_DRAG,!1),v.length&&(C.getTargetChart.selectId.forEach(P=>{if(!u.has(P))return;const k=C.fetchTargetIndex(P),y=C.getComponentList[k];v.forEach(L=>{L.id===P&&(L.attr=Object.assign(L.attr,{offsetX:y.attr.x-L.attr.x,offsetY:y.attr.y-L.attr.y}))})}),C.moveComponentList(v)),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",m)}catch(P){console.log(P)}};document.addEventListener("mousemove",p),document.addEventListener("mouseup",m)},mouseenterHandle:(d,r)=>{d.preventDefault(),d.stopPropagation(),C.getEditCanvas.isSelect||C.setTargetHoverChart(r.id)},mouseleaveHandle:(d,r)=>{d.preventDefault(),d.stopPropagation(),C.setEditCanvas(st.IS_DRAG,!1),C.setTargetHoverChart(void 0)},useMouseHandle:Ee,touchstartHandle:(d,r)=>{if(console.log("e =>",d),console.log("item =>",r),d.preventDefault(),d.stopPropagation(),r.status.lock)return;Be();const s=new Map;C.getTargetChart.selectId.forEach(f=>{const v=C.fetchTargetIndex(f);if(v!==-1){const{x:p,y:m,w:_,h:P}=Le(C.getComponentList[v]).attr;s.set(f,{x:p,y:m,w:_,h:P})}}),C.setTargetSelectChart(r.id);const e=d.touches[0].screenX,n=d.touches[0].screenY;let i=[];C.getTargetChart.selectId.forEach(f=>{if(!s.has(f))return;const v=C.fetchTargetIndex(f);i.push(Mt.cloneDeep(C.getComponentList[v]))}),C.setMousePosition(void 0,void 0,e,n);const u=Mt.throttle(f=>{C.setEditCanvas(st.IS_DRAG,!0),C.setMousePosition(f.touches[0].screenX,f.touches[0].screenY);const v=(f.touches[0].screenX-e)/C.getEditCanvas.scale,p=(f.touches[0].screenY-n)/C.getEditCanvas.scale;C.getTargetChart.selectId.forEach(m=>{if(!s.has(m))return;const _=C.fetchTargetIndex(m),{x:P,y:k,w:y,h:L}=s.get(m),A=C.getComponentList[_];let B=Math.round(P+v),H=Math.round(k+p);const S=50;B=B<-y+S?-y+S:B,H=H<-L+S?-L+S:H,B=B>C.getEditCanvasConfig.width-S?C.getEditCanvasConfig.width-S:B,H=H>C.getEditCanvasConfig.height-S?C.getEditCanvasConfig.height-S:H,A&&(A.attr=Object.assign(A.attr,{x:B,y:H}))})},20),h=()=>{try{C.setMousePosition(0,0,0,0),C.setEditCanvas(st.IS_DRAG,!1),i.length&&(C.getTargetChart.selectId.forEach(f=>{if(!s.has(f))return;const v=C.fetchTargetIndex(f),p=C.getComponentList[v];i.forEach(m=>{m.id===f&&(m.attr=Object.assign(m.attr,{offsetX:p.attr.x-m.attr.x,offsetY:p.attr.y-m.attr.y}))})}),C.moveComponentList(i))}catch(f){console.log(f)}};document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",h)}}),qn=(c,t,o)=>{c.stopPropagation(),c.preventDefault(),C.setEditCanvas(st.IS_DRAG,!0);const a=C.getEditCanvas.scale,l=o.x,d=o.y,r=o.w,s=o.h,e=c.screenX,n=c.screenY;C.setMousePosition(e,n);const i=Mt.throttle(h=>{C.setMousePosition(h.screenX,h.screenY);let f=Math.round((h.screenX-e)/a),v=Math.round((h.screenY-n)/a);const p=/t/.test(t),m=/b/.test(t),_=/l/.test(t),P=/r/.test(t),k=s+(p?-v:m?v:0),y=r+(_?-f:P?f:0);o.h=k>0?k:0,o.w=y>0?y:0,o.x=l+(_?f:0),o.y=d+(p?v:0)},50),u=()=>{C.setEditCanvas(st.IS_DRAG,!1),C.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",u)},Wt=(c,t)=>c?{zIndex:c.zIndex===-1?t+1:c.zIndex+t+1,left:`${c.x}px`,top:`${c.y}px`}:{},wt=(c,t)=>c?{width:`${t?t*c.w:c.w}px`,height:`${t?t*c.h:c.h}px`}:{},Vn=(c,t,o,a)=>{const{w:l,h:d}=o,r=/t/.test(c),s=/b/.test(c),e=/l/.test(c),n=/r/.test(c);let i=0,u=0;return c.length===2?(i=e?0:l,u=r?0:d):((r||s)&&(i=l/2,u=r?0:d),(e||n)&&(i=e?0:l,u=Math.floor(d/2))),{left:`${i}px`,top:`${u}px`,cursor:a[t]+"-resize"}};const Jn=["onMousedown"],Zn=ft({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(c){const t=c;Qt(u=>({"6f41483b":r.value}));const o=qt(),a=ct(),l=["t","r","b","l","lt","rt","lb","rb"],d=["n","e","s","w","nw","ne","sw","se"],r=U(()=>o.getAppTheme),s=U(()=>t.item.status.lock?!1:t.item.id===a.getTargetChart.hoverId),e=U(()=>{const u=t.item.id;return t.item.status.lock?!1:a.getTargetChart.selectId.find(h=>h===u)}),n=U(()=>t.item.status.lock),i=U(()=>t.item.status.hide);return(u,h)=>(O(),at("div",{class:pt(["go-shape-box",{lock:n.value,hide:i.value}])},[ve(u.$slots,"default",{},void 0,!0),c.hiddenPoint?Vt("",!0):(O(!0),at(Tt,{key:0},Rt(e.value?l:[],(f,v)=>(O(),at("div",{class:pt(`shape-point ${f}`),key:v,style:it(E(Vn)(f,v,c.item.attr,d)),onMousedown:p=>E(qn)(p,f,c.item.attr)},null,46,Jn))),128)),G("div",{class:"shape-modal",style:it(E(wt)(c.item.attr))},[G("div",{class:pt(["shape-modal-select",{active:e.value}])},null,2),G("div",{class:pt(["shape-modal-change",{selectActive:e.value,hoverActive:s.value}])},null,2)],4)],2))}}),de=Ct(Zn,[["__scopeId","data-v-f03fb462"]]),jn={class:"go-edit-group-box"},to=ft({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(c){const t=ct(),{handleContextMenu:o}=_e(),{mouseenterHandle:a,mouseleaveHandle:l,mousedownHandle:d,mouseClickHandle:r}=Ee(),s=(i,u,h)=>{const f=v=>u.filter(p=>v.includes(p.key));if(t.getTargetChart.selectId.length>1)return f([T.GROUP,T.DELETE]);{const v=[];h.status.lock?v.push(T.LOCK):v.push(T.UNLOCK),h.status.hide?v.push(T.HIDE):v.push(T.SHOW);const p=[T.UN_GROUP];return[...f(p),Rn(),...i.filter(m=>!v.includes(m.key))]}},e=U(()=>Qe(t.getEditCanvasConfig.chartCustomThemeColorInfo)[t.getEditCanvasConfig.chartThemeColor]),n=U(()=>t.getEditCanvasConfig.chartThemeSetting);return(i,u)=>(O(),at("div",jn,[(O(),Z(E(de),{key:c.groupData.id,"data-id":c.groupData.id,index:c.groupIndex,item:c.groupData,hiddenPoint:!0,class:pt(E(re)(c.groupData.styles.animations)),style:it(W(W(W(W(W({},E(Wt)(c.groupData.attr,c.groupIndex)),E(wt)(c.groupData.attr)),E($t)(c.groupData.styles)),E(ie)(c.groupData.styles)),E(qe)(c.groupData.styles))),onClick:u[0]||(u[0]=h=>E(r)(h,c.groupData)),onMousedown:u[1]||(u[1]=h=>E(d)(h,c.groupData)),onMouseenter:u[2]||(u[2]=h=>E(a)(h,c.groupData)),onMouseleave:u[3]||(u[3]=h=>E(l)(h,c.groupData)),onContextmenu:u[4]||(u[4]=h=>E(o)(h,c.groupData,s))},{default:F(()=>[(O(!0),at(Tt,null,Rt(c.groupData.groupList,h=>(O(),Z(E(de),{key:h.id,"data-id":h.id,index:c.groupIndex,item:h,hiddenPoint:!0,style:it(W({},E(Wt)(h.attr,c.groupIndex)))},{default:F(()=>[(O(),Z(St(h.chartConfig.chartKey),{class:pt(["edit-content-chart",E(re)(h.styles.animations)]),chartConfig:h,themeSetting:n.value,themeColor:e.value,style:it(W(W(W({},E(wt)(h.attr)),E($t)(h.styles)),E(ie)(h.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const eo={class:"go-edit-align-line"},no=ft({__name:"index",setup(c){Qt(v=>({42514545:r.value}));const t=qt(),o=ct(),a=Ve(),l=ge({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),d=v=>v?{left:`${v.x?v.x:0}px`,top:`${v.y?v.y:0}px`}:{},r=U(()=>t.getAppTheme),s=U(()=>a.getChartAlignRange),e=U(()=>o.getEditCanvas[st.IS_DRAG]),n=(v,p)=>Math.abs(v-p)<=s.value,i=U(()=>o.getTargetChart.selectId),u=U(()=>o.getComponentList[o.fetchTargetIndex()]),h=U(()=>{var v;return((v=u.value)==null?void 0:v.attr)||{}}),f=U(()=>({id:"0",attr:{w:ke(o.getEditCanvasConfig.width),h:ke(o.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return mt(()=>o.getMousePosition,ot(()=>{try{if(!e.value||i.value.length!==1)return;const v=h.value.w,p=h.value.h,m=h.value.x,_=m+v/2,P=m+v,k=[m,_,P],y=h.value.y,L=y+p/2,A=y+p,B=[y,L,A];l.select.clear(),l.sorptioned.y=!1;const H=o.getComponentList.map(S=>({id:S.id,attr:S.attr}));H.push(f.value),l.lineArr.forEach(S=>{H.forEach(q=>{if(i.value[0]===q.id)return;const b=q.attr.w,D=q.attr.h,R=q.attr.x,g=R+b/2,w=R+b,M=[R,g,w],x=q.attr.y,z=x+D/2,N=x+D,lt=[x,z,N];S.includes("rowt")&&(n(y,x)&&(l.select.set(S,{y:x}),Q(u.value,m,x)),n(y,z)&&(l.select.set(S,{y:z}),Q(u.value,m,z)),n(y,N)&&(l.select.set(S,{y:N}),Q(u.value,m,N))),S.includes("rowc")&&(n(L,x)&&(l.select.set(S,{y:x}),Q(u.value,m,x-p/2)),n(L,z)&&(l.select.set(S,{y:z}),Q(u.value,m,z-p/2)),n(L,N)&&(l.select.set(S,{y:N}),Q(u.value,m,N-p/2))),S.includes("rowb")&&(n(A,x)&&(l.select.set(S,{y:x}),Q(u.value,m,x-p)),n(A,z)&&(l.select.set(S,{y:z}),Q(u.value,m,z-p)),n(A,N)&&(l.select.set(S,{y:N}),Q(u.value,m,N-p))),S.includes("coll")&&(n(m,R)&&(l.select.set(S,{x:R}),Q(u.value,R,y)),n(m,g)&&(l.select.set(S,{x:g}),Q(u.value,g,y)),n(m,w)&&(l.select.set(S,{x:w}),Q(u.value,w,y))),S.includes("colc")&&(n(_,R)&&(l.select.set(S,{x:R}),Q(u.value,R-v/2,y)),n(_,g)&&(l.select.set(S,{x:g}),Q(u.value,g-v/2,y)),n(_,w)&&(l.select.set(S,{x:w}),Q(u.value,w-v/2,y))),S.includes("colr")&&(n(P,R)&&(l.select.set(S,{x:R}),Q(u.value,R-v,y)),n(P,g)&&(l.select.set(S,{x:g}),Q(u.value,g-v,y)),n(P,w)&&(l.select.set(S,{x:w}),Q(u.value,w-v,y)))})})}catch(v){console.log(v)}},200),{deep:!0}),mt(()=>e.value,v=>{v||(l.select.clear(),l.sorptioned.y=!1)}),(v,p)=>(O(),at("div",eo,[(O(!0),at(Tt,null,Rt(l.lineArr,m=>(O(),at("div",{class:pt(["line",[m.includes("row")?"row":"col",l.select.has(m)&&"visible"]]),key:m,style:it(d(l.select.get(m)))},null,6))),128))]))}}),oo=Ct(no,[["__scopeId","data-v-403a9eed"]]);const un=c=>(me("data-v-71d41248"),c=c(),Ce(),c),so=un(()=>G("div",{class:"select-background"},null,-1)),ao=un(()=>G("div",{class:"select-border"},null,-1)),ro=[so,ao],io=ft({__name:"index",setup(c){Qt(s=>({c29aca42:d.value}));const t=qt(),o=ct(),{isSelect:a,scale:l}=pe(o.getEditCanvas),d=U(()=>t.getAppTheme),r=X();return mt(()=>o.getMousePosition,s=>{if(!a.value)return;const{startX:e,startY:n,x:i,y:u}=s,h={zIndex:Re,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};i>e&&u>n?(h.x=e,h.y=n,h.w=Math.round((i-e)/l.value),h.h=Math.round((u-n)/l.value)):i>e&&u<n?(h.x=e,h.w=Math.round((i-e)/l.value),h.h=Math.round((n-u)/l.value),h.y=n-h.h):i<e&&u>n?(h.y=n,h.w=Math.round((e-i)/l.value),h.h=Math.round((u-n)/l.value),h.x=e-h.w):(h.w=Math.round((e-i)/l.value),h.h=Math.round((n-u)/l.value),h.x=e-h.w,h.y=n-h.h),r.value=W(W({},Wt(h,Re)),wt(h))},{deep:!0}),(s,e)=>E(a)?(O(),at("div",{key:0,class:"go-edit-select",style:it(r.value)},ro,4)):Vt("",!0)}}),co=Ct(io,[["__scopeId","data-v-71d41248"]]);const lo=ft({__name:"index",setup(c){const t=ct(),{getEditCanvasConfig:o,getEditCanvas:a}=pe(t),l=U(()=>({w:o.value.width,h:o.value.height})),d=U(()=>{const s={transform:`scale(${a.value.scale})`};return W(W({},wt(l.value)),s)}),r=U(()=>{const s=a.value.isCreate&&{"z-index":99999};return W(W({},wt(l.value)),s)});return(s,e)=>(O(),at("div",{class:"go-edit-range go-transition",style:it(d.value),onMousedown:e[0]||(e[0]=n=>E(Qn)(n,void 0))},[ve(s.$slots,"default",{},void 0,!0),K(E(oo)),K(E(co)),G("div",{class:"go-edit-range-model",style:it(r.value)},null,4)],36))}}),uo=Ct(lo,[["__scopeId","data-v-00f6546e"]]),dn=!!(typeof window!="undefined"&&window.document&&window.document.createElement);var he=!1,fe=!1;try{var oe={get passive(){return he=!0},get once(){return fe=he=!0}};dn&&(window.addEventListener("test",oe,oe),window.removeEventListener("test",oe,!0))}catch(c){}function ho(c,t,o,a){if(a&&typeof a!="boolean"&&!fe){var l=a.once,d=a.capture,r=o;!fe&&l&&(r=o.__once||function s(e){this.removeEventListener(t,s,d),o.call(this,e)},o.__once=r),c.addEventListener(t,r,he?a:d)}c.addEventListener(t,o,a)}function fo(c,t,o,a){var l=a&&typeof a!="boolean"?a.capture:a;c.removeEventListener(t,o,l),o.__once&&c.removeEventListener(t,o.__once,l)}function He(c,t,o,a){return ho(c,t,o,a),function(){fo(c,t,o,a)}}var $e=new Date().getTime();function vo(c){var t=new Date().getTime(),o=Math.max(0,16-(t-$e)),a=setTimeout(c,o);return $e=t,a}var go=["","webkit","moz","o","ms"],ze=vo,We=function(t,o){return t+(t?o[0].toUpperCase()+o.substr(1):o)+"AnimationFrame"};dn&&go.some(function(c){var t=We(c,"request");return t in window&&(We(c,"cancel"),ze=function(a){return window[t](a)}),!!ze});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const po={class:"go-sketch-rule"},mo={key:0,class:"fix-edit-screens-block"},se=20,Co=ft({__name:"index",setup(c){Qt(b=>({"16f39c63":y.value,"393c6a8e":P.value,bb12685c:u.value}));const t=ct(),o=an(),a=qt();let l=[0,0],d=[0,0];const r=X(),s=X(!0),e=X(),n=X(),i=X(!1),u=X("auto"),{width:h,height:f}=pe(t.getEditCanvasConfig),v=X(0),p=X(0),m=ge({h:[],v:[]}),_=U(()=>t.getEditCanvas.scale),P=U(()=>`${f.value*2}px`),k=U(()=>a.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),y=U(()=>a.getAppTheme),L=b=>{if(b.ctrlKey||b.metaKey){b.preventDefault();let D=_.value;if(b.wheelDelta>=0&&_.value<2){D=_.value+.05,t.setScale(D);return}b.wheelDelta<0&&_.value>.1&&(D=_.value-.05,t.setScale(D))}},A=()=>{if(!r.value)return;const b=r.value.getBoundingClientRect(),D=e.value.getBoundingClientRect();v.value=(b.left+se-D.left)/_.value,p.value=(b.top+se-D.top)/_.value},B=b=>{var M,x;if(b.preventDefault(),b.stopPropagation(),b.which==2)i.value=!0;else if(!((M=window.$KeyboardActive)!=null&&M.space))return;(x=document.activeElement)==null||x.blur();const D=b.pageX,R=b.pageY,g=He(window,"mousemove",z=>{const N=z.pageX-D,lt=z.pageY-R,[I,Y]=l,[$,vt]=d;l=[Y,N],d=[vt,lt],r.value.scrollLeft-=Y>I?Math.abs(Y-I):-Math.abs(Y-I),r.value.scrollTop-=vt>$?Math.abs(vt-$):-Math.abs(vt-$)}),w=He(window,"mouseup",()=>{g(),w(),l=[0,0],d=[0,0],i.value=!1})},H=()=>{const b=document.getElementById("go-chart-edit-layout");return b?{height:b.clientHeight-25,width:b.clientWidth}:{width:h.value,height:f.value}},S=()=>{s.value=!1,setTimeout(()=>{s.value=!0},10)},q=()=>{const{width:b,height:D}=n.value.getBoundingClientRect(),{width:R,height:g}=H();r.value.scrollLeft=b/2-R/2,r.value.scrollTop=D/2-g/2};return mt(()=>a.getDarkTheme,()=>{S()}),mt(()=>_.value,(b,D)=>{D!==b&&o.getRePositionCanvas?(o.setItemUnHandle(le.RE_POSITION_CANVAS,!1),A(),setTimeout(()=>{q(),S()},400)):ot(S,20)}),mt(()=>i.value,b=>{u.value=b?"grab":"auto"}),Xt(()=>{r.value&&(r.value.addEventListener("wheel",L,{passive:!1}),q())}),Ge(()=>{r.value&&r.value.removeEventListener("wheel",L)}),window.onKeySpacePressHold=b=>{i.value=b},(b,D)=>{const R=dt("sketch-rule");return O(),at("div",po,[Bt(K(R,{thick:se,scale:_.value,width:H().width,height:H().height,startX:v.value,startY:p.value,lines:m,palette:k.value},null,8,["scale","width","height","startX","startY","lines","palette"]),[[Ft,!1]]),G("div",{ref_key:"$app",ref:r,class:"edit-screens",onScroll:A},[G("div",{ref_key:"$container",ref:n,class:"edit-screen-container",style:it({width:E(h)*2+"px"})},[G("div",{ref_key:"refSketchRuleBox",ref:e,class:"canvas",onMousedown:B,style:it({marginLeft:"-"+(H().width/2-25)+"px"})},[G("div",{style:it({pointerEvents:i.value?"none":"auto"})},[ve(b.$slots,"default",{},void 0,!0)],4)],36)],4)],544),E(a).getDarkTheme?(O(),at("div",mo)):Vt("",!0)])}}}),_o=Ct(Co,[["__scopeId","data-v-c6872036"]]);/*!
 * Signature Pad v4.1.5 | https://github.com/szimek/signature_pad
 * (c) 2023 Szymon Nowak | Released under the MIT license
 */class Yt{constructor(t,o,a,l){if(isNaN(t)||isNaN(o))throw new Error(`Point is invalid: (${t}, ${o})`);this.x=+t,this.y=+o,this.pressure=a||0,this.time=l||Date.now()}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y&&this.pressure===t.pressure&&this.time===t.time}velocityFrom(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):0}}class ye{constructor(t,o,a,l,d,r){this.startPoint=t,this.control2=o,this.control1=a,this.endPoint=l,this.startWidth=d,this.endWidth=r}static fromPoints(t,o){const a=this.calculateControlPoints(t[0],t[1],t[2]).c2,l=this.calculateControlPoints(t[1],t[2],t[3]).c1;return new ye(t[1],a,l,t[2],o.start,o.end)}static calculateControlPoints(t,o,a){const l=t.x-o.x,d=t.y-o.y,r=o.x-a.x,s=o.y-a.y,e={x:(t.x+o.x)/2,y:(t.y+o.y)/2},n={x:(o.x+a.x)/2,y:(o.y+a.y)/2},i=Math.sqrt(l*l+d*d),u=Math.sqrt(r*r+s*s),h=e.x-n.x,f=e.y-n.y,v=u/(i+u),p={x:n.x+h*v,y:n.y+f*v},m=o.x-p.x,_=o.y-p.y;return{c1:new Yt(e.x+m,e.y+_),c2:new Yt(n.x+m,n.y+_)}}length(){let o=0,a,l;for(let d=0;d<=10;d+=1){const r=d/10,s=this.point(r,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),e=this.point(r,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(d>0){const n=s-a,i=e-l;o+=Math.sqrt(n*n+i*i)}a=s,l=e}return o}point(t,o,a,l,d){return o*(1-t)*(1-t)*(1-t)+3*a*(1-t)*(1-t)*t+3*l*(1-t)*t*t+d*t*t*t}}class wo{constructor(){try{this._et=new EventTarget}catch(t){this._et=document}}addEventListener(t,o,a){this._et.addEventListener(t,o,a)}dispatchEvent(t){return this._et.dispatchEvent(t)}removeEventListener(t,o,a){this._et.removeEventListener(t,o,a)}}function Eo(c,t=250){let o=0,a=null,l,d,r;const s=()=>{o=Date.now(),a=null,l=c.apply(d,r),a||(d=null,r=[])};return function(...n){const i=Date.now(),u=t-(i-o);return d=this,r=n,u<=0||u>t?(a&&(clearTimeout(a),a=null),o=i,l=c.apply(d,r),a||(d=null,r=[])):a||(a=window.setTimeout(s,u)),l}}class Gt extends wo{constructor(t,o={}){super(),this.canvas=t,this._drawningStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this._handleMouseDown=a=>{a.buttons===1&&(this._drawningStroke=!0,this._strokeBegin(a))},this._handleMouseMove=a=>{this._drawningStroke&&this._strokeMoveUpdate(a)},this._handleMouseUp=a=>{a.buttons===1&&this._drawningStroke&&(this._drawningStroke=!1,this._strokeEnd(a))},this._handleTouchStart=a=>{if(a.cancelable&&a.preventDefault(),a.targetTouches.length===1){const l=a.changedTouches[0];this._strokeBegin(l)}},this._handleTouchMove=a=>{a.cancelable&&a.preventDefault();const l=a.targetTouches[0];this._strokeMoveUpdate(l)},this._handleTouchEnd=a=>{if(a.target===this.canvas){a.cancelable&&a.preventDefault();const d=a.changedTouches[0];this._strokeEnd(d)}},this._handlePointerStart=a=>{this._drawningStroke=!0,a.preventDefault(),this._strokeBegin(a)},this._handlePointerMove=a=>{this._drawningStroke&&(a.preventDefault(),this._strokeMoveUpdate(a))},this._handlePointerEnd=a=>{this._drawningStroke&&(a.preventDefault(),this._drawningStroke=!1,this._strokeEnd(a))},this.velocityFilterWeight=o.velocityFilterWeight||.7,this.minWidth=o.minWidth||.5,this.maxWidth=o.maxWidth||2.5,this.throttle="throttle"in o?o.throttle:16,this.minDistance="minDistance"in o?o.minDistance:5,this.dotSize=o.dotSize||0,this.penColor=o.penColor||"black",this.backgroundColor=o.backgroundColor||"rgba(0,0,0,0)",this._strokeMoveUpdate=this.throttle?Eo(Gt.prototype._strokeUpdate,this.throttle):Gt.prototype._strokeUpdate,this._ctx=t.getContext("2d"),this.clear(),this.on()}clear(){const{_ctx:t,canvas:o}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,o.width,o.height),t.fillRect(0,0,o.width,o.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0}fromDataURL(t,o={}){return new Promise((a,l)=>{const d=new Image,r=o.ratio||window.devicePixelRatio||1,s=o.width||this.canvas.width/r,e=o.height||this.canvas.height/r,n=o.xOffset||0,i=o.yOffset||0;this._reset(this._getPointGroupOptions()),d.onload=()=>{this._ctx.drawImage(d,n,i,s,e),a()},d.onerror=u=>{l(u)},d.crossOrigin="anonymous",d.src=t,this._isEmpty=!1})}toDataURL(t="image/png",o){switch(t){case"image/svg+xml":return typeof o!="object"&&(o=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(o))}`;default:return typeof o!="number"&&(o=void 0),this.canvas.toDataURL(t,o)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const t=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!t?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerStart),this.canvas.removeEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.removeEventListener("pointerup",this._handlePointerEnd),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(t,{clear:o=!0}={}){o&&this.clear(),this._fromData(t,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(t)}toData(){return this._data}_getPointGroupOptions(t){return{penColor:t&&"penColor"in t?t.penColor:this.penColor,dotSize:t&&"dotSize"in t?t.dotSize:this.dotSize,minWidth:t&&"minWidth"in t?t.minWidth:this.minWidth,maxWidth:t&&"maxWidth"in t?t.maxWidth:this.maxWidth,velocityFilterWeight:t&&"velocityFilterWeight"in t?t.velocityFilterWeight:this.velocityFilterWeight}}_strokeBegin(t){this.dispatchEvent(new CustomEvent("beginStroke",{detail:t}));const o=this._getPointGroupOptions(),a=Object.assign(Object.assign({},o),{points:[]});this._data.push(a),this._reset(o),this._strokeUpdate(t)}_strokeUpdate(t){if(this._data.length===0){this._strokeBegin(t);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:t}));const o=t.clientX,a=t.clientY,l=t.pressure!==void 0?t.pressure:t.force!==void 0?t.force:0,d=this._createPoint(o,a,l),r=this._data[this._data.length-1],s=r.points,e=s.length>0&&s[s.length-1],n=e?d.distanceTo(e)<=this.minDistance:!1,i=this._getPointGroupOptions(r);if(!e||!(e&&n)){const u=this._addPoint(d,i);e?u&&this._drawCurve(u,i):this._drawDot(d,i),s.push({time:d.time,x:d.x,y:d.y,pressure:d.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:t}))}_strokeEnd(t){this._strokeUpdate(t),this.dispatchEvent(new CustomEvent("endStroke",{detail:t}))}_handlePointerEvents(){this._drawningStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerStart),this.canvas.addEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.addEventListener("pointerup",this._handlePointerEnd)}_handleMouseEvents(){this._drawningStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(t){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(t.minWidth+t.maxWidth)/2,this._ctx.fillStyle=t.penColor}_createPoint(t,o,a){const l=this.canvas.getBoundingClientRect();return new Yt(t-l.left,o-l.top,a,new Date().getTime())}_addPoint(t,o){const{_lastPoints:a}=this;if(a.push(t),a.length>2){a.length===3&&a.unshift(a[0]);const l=this._calculateCurveWidths(a[1],a[2],o),d=ye.fromPoints(a,l);return a.shift(),d}return null}_calculateCurveWidths(t,o,a){const l=a.velocityFilterWeight*o.velocityFrom(t)+(1-a.velocityFilterWeight)*this._lastVelocity,d=this._strokeWidth(l,a),r={end:d,start:this._lastWidth};return this._lastVelocity=l,this._lastWidth=d,r}_strokeWidth(t,o){return Math.max(o.maxWidth/(t+1),o.minWidth)}_drawCurveSegment(t,o,a){const l=this._ctx;l.moveTo(t,o),l.arc(t,o,a,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(t,o){const a=this._ctx,l=t.endWidth-t.startWidth,d=Math.ceil(t.length())*2;a.beginPath(),a.fillStyle=o.penColor;for(let r=0;r<d;r+=1){const s=r/d,e=s*s,n=e*s,i=1-s,u=i*i,h=u*i;let f=h*t.startPoint.x;f+=3*u*s*t.control1.x,f+=3*i*e*t.control2.x,f+=n*t.endPoint.x;let v=h*t.startPoint.y;v+=3*u*s*t.control1.y,v+=3*i*e*t.control2.y,v+=n*t.endPoint.y;const p=Math.min(t.startWidth+n*l,o.maxWidth);this._drawCurveSegment(f,v,p)}a.closePath(),a.fill()}_drawDot(t,o){const a=this._ctx,l=o.dotSize>0?o.dotSize:(o.minWidth+o.maxWidth)/2;a.beginPath(),this._drawCurveSegment(t.x,t.y,l),a.closePath(),a.fillStyle=o.penColor,a.fill()}_fromData(t,o,a){for(const l of t){const{points:d}=l,r=this._getPointGroupOptions(l);if(d.length>1)for(let s=0;s<d.length;s+=1){const e=d[s],n=new Yt(e.x,e.y,e.pressure,e.time);s===0&&this._reset(r);const i=this._addPoint(n,r);i&&o(i,r)}else this._reset(r),a(d[0],r)}}toSVG({includeBackgroundColor:t=!1}={}){const o=this._data,a=Math.max(window.devicePixelRatio||1,1),l=0,d=0,r=this.canvas.width/a,s=this.canvas.height/a,e=document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.setAttribute("viewBox",`${l} ${d} ${r} ${s}`),e.setAttribute("width",r.toString()),e.setAttribute("height",s.toString()),t&&this.backgroundColor){const n=document.createElement("rect");n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("fill",this.backgroundColor),e.appendChild(n)}return this._fromData(o,(n,{penColor:i})=>{const u=document.createElement("path");if(!isNaN(n.control1.x)&&!isNaN(n.control1.y)&&!isNaN(n.control2.x)&&!isNaN(n.control2.y)){const h=`M ${n.startPoint.x.toFixed(3)},${n.startPoint.y.toFixed(3)} C ${n.control1.x.toFixed(3)},${n.control1.y.toFixed(3)} ${n.control2.x.toFixed(3)},${n.control2.y.toFixed(3)} ${n.endPoint.x.toFixed(3)},${n.endPoint.y.toFixed(3)}`;u.setAttribute("d",h),u.setAttribute("stroke-width",(n.endWidth*2.25).toFixed(3)),u.setAttribute("stroke",i),u.setAttribute("fill","none"),u.setAttribute("stroke-linecap","round"),e.appendChild(u)}},(n,{penColor:i,dotSize:u,minWidth:h,maxWidth:f})=>{const v=document.createElement("circle"),p=u>0?u:(h+f)/2;v.setAttribute("r",p.toString()),v.setAttribute("cx",n.x.toString()),v.setAttribute("cy",n.y.toString()),v.setAttribute("fill",i),e.appendChild(v)}),e.outerHTML}}const yo={class:"list-content"},So={class:"list-content-img"},Mo={ref:"signatureCanvas",id:"signatureCanvas"},xo=ft({__name:"index",props:{modalShow:{required:!0,type:Boolean}},emits:["close","edit"],setup(c,{emit:t}){const o=c,{HammerIcon:a}=rn.ionicons5,l=X(!1),d=ct();let r;mt(()=>o.modalShow,n=>{l.value=n,n&&Je(()=>{const i=document.getElementById("signatureCanvas");i.width=1e3,i.height=350,i.style.backgroundColor="#FFFFFF",r=new Gt(i,{penColor:"black",backgroundColor:"rgba(0, 0, 0, 0)",minWidth:2,maxWidth:5})})},{immediate:!0}),ge([{label:Mn("global.r_edit"),key:"edit",icon:xn(a)}]);const s=()=>{const n=r.toDataURL();d.setSingCanvas(n),l.value=!1},e=()=>{t("close")};return(n,i)=>{const u=dt("n-text"),h=dt("n-space"),f=dt("n-button"),v=dt("n-card"),p=dt("n-modal");return O(),Z(p,{class:"go-modal-box",show:l.value,"onUpdate:show":i[1]||(i[1]=m=>l.value=m),onAfterLeave:e},{default:F(()=>[K(v,{hoverable:"",size:"small"},{action:F(()=>[K(h,{class:"list-footer",justify:"space-between"},{default:F(()=>[K(u,{depth:"3"}),K(h,null,{default:F(()=>[K(f,{type:"primary",ghost:"",onClick:i[0]||(i[0]=m=>s())},{default:F(()=>[zt(" 保存并关闭 ")]),_:1})]),_:1})]),_:1})]),default:F(()=>[G("div",yo,[K(h,{class:"list-content-top go-px-0",justify:"center"},{default:F(()=>[K(h,null,{default:F(()=>[K(u,null,{default:F(()=>[zt(" 签名 ")]),_:1})]),_:1})]),_:1}),G("div",So,[G("canvas",Mo,null,512)])])]),_:1})]),_:1},8,["show"])}}}),To=Ct(xo,[["__scopeId","data-v-7177ee91"]]),Po=c=>c,bo=(c,t)=>{try{if(t.id){const o="vnodeBeforeMount"in t.events,a="vnodeMounted"in t.events;return o&&(c.events.advancedEvents.vnodeBeforeMount=t==null?void 0:t.events.vnodeBeforeMount),a&&(c.events.advancedEvents.vnodeMounted=t==null?void 0:t.events.vnodeMounted),(o||a)&&(t.events={baseEvent:{[Ot.ON_CLICK]:void 0,[Ot.ON_DBL_CLICK]:void 0,[Ot.ON_MOUSE_ENTER]:void 0,[Ot.ON_MOUSE_LEAVE]:void 0},advancedEvents:{[Ae.VNODE_MOUNTED]:void 0,[Ae.VNODE_BEFORE_MOUNT]:void 0},interactEvents:[]}),c}}catch(o){return c}},_t=(c,t,o=!1)=>{if(bo(c,t),o)return ne(c,t);const a=t.option;if(!a)return ne(c,t);if(t.option=void 0,a)return bt(W({},ne(c,t)),{option:a})},hn=()=>{const c=ct(),t=An(),o=an();return{updateComponent:(l,d=!1,r=!1)=>ht(void 0,null,function*(){d&&(c.componentList=[],t.clearBackStack(),t.clearForwardStack()),l.editCanvasConfig=Po(l.editCanvasConfig),l.componentList.forEach(e=>ht(void 0,null,function*(){const n=i=>{window.$vue.component(i.chartConfig.chartKey)||(window.$vue.component(i.chartConfig.chartKey,en(i.chartConfig)),window.$vue.component(i.chartConfig.conKey,nn(i.chartConfig)))};e.isGroup?e.groupList.forEach(i=>{n(i)}):n(e)}));const s=(e,n)=>ht(void 0,null,function*(){let i=yield we(e.chartConfig);n?n(r?_t(i,bt(W({},e),{id:ee()})):_t(i,e)):r?c.addComponentList(_t(i,bt(W({},e),{id:ee()})),!1,!0):c.addComponentList(_t(i,e),!1,!0)});for(const e in l)if(e===Dn.COMPONENT_LIST){let n=0;const i=l[e].length;for(const u of l[e]){let h=parseInt((parseFloat(`${++n/i}`)*100).toString());if(o.setItemUnHandle(le.PERCENTAGE,h),u.isGroup){let f=new On;r?f=_t(f,bt(W({},u),{id:ee()})):f=_t(f,u);const v=[];for(const p of u.groupList)yield s(p,m=>{v.push(m)});f.groupList=v,c.addComponentList(f,!1,!0)}else yield s(u)}}else{if(e!=="editCanvasConfig"&&e!=="requestGlobalConfig")return;_t(c[e],l[e],!0)}o.setItemUnHandle(le.PERCENTAGE,0)})}},Lo=()=>{const c=X(),{updateComponent:t}=hn();return{importUploadFileListRef:c,importBeforeUpload:({file:l})=>{c.value=[];const d=l.file.type;return d!==Ue.JSON&&d!==Ue.TXT?(window.$message.warning("仅支持上传 【JSON】 格式文件，请重新上传！"),!1):!0},importCustomRequest:l=>{const{file:d}=l;Je(()=>{d.file?Fn(d.file).then(r=>{Nn({message:"请选择导入方式:",positiveText:"新增（可撤回）",negativeText:"覆盖（不可撤回）",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>ht(void 0,null,function*(){try{r=ae(r),yield t(r,!1,!0),window.$message.success("导入成功！")}catch(s){console.log(s),window.$message.error("组件导入失败，请检查文件完整性!")}}),onNegativeCallback:()=>ht(void 0,null,function*(){try{r=ae(r),yield t(r,!0,!0),window.$message.success("导入成功！")}catch(s){console.log(s),window.$message.error("组件导入失败，请检查文件完整性!")}})})}):window.$message.error("导入失败，请检查数据或联系管理员！")})}}},{updateComponent:ko}=hn(),fn=ct(),Ye=()=>{dispatchEvent(new CustomEvent(Ht.CHART_TO_PREVIEW,{detail:fn.getStorageInfo}))},Ro=()=>{const c=d=>{window.$message.success("正在进行更新..."),ko(d.detail,!0)},t=()=>{fn.setEditCanvas(st.IS_CODE_EDIT,!1)},o=()=>{addEventListener("blur",Ye),addEventListener(Ht.JSON,c),addEventListener(Ht.CLOSE,ot(t,1e3))},a=()=>{removeEventListener("blur",Ye),removeEventListener(Ht.JSON,c)};return(d,r)=>{r==De.CHART_HOME_NAME&&a(),d==De.CHART_HOME_NAME&&o()}},Ao=()=>{const c=Ze();mt(()=>c.name,Ro(),{immediate:!0})};var yt=(c=>(c.BUTTON="button",c.IMPORTUPLOAD="importUpload",c))(yt||{});/*!
 * qrcode.vue v3.4.0
 * A Vue.js component to generate QRCode.
 * © 2017-2023 @scopewu(https://github.com/scopewu)
 * MIT License.
 */var Kt=function(){return Kt=Object.assign||function(t){for(var o,a=1,l=arguments.length;a<l;a++){o=arguments[a];for(var d in o)Object.prototype.hasOwnProperty.call(o,d)&&(t[d]=o[d])}return t},Kt.apply(this,arguments)},Et;(function(c){var t=function(){function r(s,e,n,i){if(this.version=s,this.errorCorrectionLevel=e,this.modules=[],this.isFunction=[],s<r.MIN_VERSION||s>r.MAX_VERSION)throw new RangeError("Version value out of range");if(i<-1||i>7)throw new RangeError("Mask value out of range");this.size=s*4+17;for(var u=[],h=0;h<this.size;h++)u.push(!1);for(var h=0;h<this.size;h++)this.modules.push(u.slice()),this.isFunction.push(u.slice());this.drawFunctionPatterns();var f=this.addEccAndInterleave(n);if(this.drawCodewords(f),i==-1)for(var v=1e9,h=0;h<8;h++){this.applyMask(h),this.drawFormatBits(h);var p=this.getPenaltyScore();p<v&&(i=h,v=p),this.applyMask(h)}l(0<=i&&i<=7),this.mask=i,this.applyMask(i),this.drawFormatBits(i),this.isFunction=[]}return r.encodeText=function(s,e){var n=c.QrSegment.makeSegments(s);return r.encodeSegments(n,e)},r.encodeBinary=function(s,e){var n=c.QrSegment.makeBytes(s);return r.encodeSegments([n],e)},r.encodeSegments=function(s,e,n,i,u,h){if(n===void 0&&(n=1),i===void 0&&(i=40),u===void 0&&(u=-1),h===void 0&&(h=!0),!(r.MIN_VERSION<=n&&n<=i&&i<=r.MAX_VERSION)||u<-1||u>7)throw new RangeError("Invalid value");var f,v;for(f=n;;f++){var p=r.getNumDataCodewords(f,e)*8,m=d.getTotalBits(s,f);if(m<=p){v=m;break}if(f>=i)throw new RangeError("Data too long")}for(var _=0,P=[r.Ecc.MEDIUM,r.Ecc.QUARTILE,r.Ecc.HIGH];_<P.length;_++){var k=P[_];h&&v<=r.getNumDataCodewords(f,k)*8&&(e=k)}for(var y=[],L=0,A=s;L<A.length;L++){var B=A[L];o(B.mode.modeBits,4,y),o(B.numChars,B.mode.numCharCountBits(f),y);for(var H=0,S=B.getData();H<S.length;H++){var q=S[H];y.push(q)}}l(y.length==v);var b=r.getNumDataCodewords(f,e)*8;l(y.length<=b),o(0,Math.min(4,b-y.length),y),o(0,(8-y.length%8)%8,y),l(y.length%8==0);for(var D=236;y.length<b;D^=253)o(D,8,y);for(var R=[];R.length*8<y.length;)R.push(0);return y.forEach(function(g,w){return R[w>>>3]|=g<<7-(w&7)}),new r(f,e,R,u)},r.prototype.getModule=function(s,e){return 0<=s&&s<this.size&&0<=e&&e<this.size&&this.modules[e][s]},r.prototype.getModules=function(){return this.modules},r.prototype.drawFunctionPatterns=function(){for(var s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var e=this.getAlignmentPatternPositions(),n=e.length,s=0;s<n;s++)for(var i=0;i<n;i++)s==0&&i==0||s==0&&i==n-1||s==n-1&&i==0||this.drawAlignmentPattern(e[s],e[i]);this.drawFormatBits(0),this.drawVersion()},r.prototype.drawFormatBits=function(s){for(var e=this.errorCorrectionLevel.formatBits<<3|s,n=e,i=0;i<10;i++)n=n<<1^(n>>>9)*1335;var u=(e<<10|n)^21522;l(u>>>15==0);for(var i=0;i<=5;i++)this.setFunctionModule(8,i,a(u,i));this.setFunctionModule(8,7,a(u,6)),this.setFunctionModule(8,8,a(u,7)),this.setFunctionModule(7,8,a(u,8));for(var i=9;i<15;i++)this.setFunctionModule(14-i,8,a(u,i));for(var i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,a(u,i));for(var i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,a(u,i));this.setFunctionModule(8,this.size-8,!0)},r.prototype.drawVersion=function(){if(!(this.version<7)){for(var s=this.version,e=0;e<12;e++)s=s<<1^(s>>>11)*7973;var n=this.version<<12|s;l(n>>>18==0);for(var e=0;e<18;e++){var i=a(n,e),u=this.size-11+e%3,h=Math.floor(e/3);this.setFunctionModule(u,h,i),this.setFunctionModule(h,u,i)}}},r.prototype.drawFinderPattern=function(s,e){for(var n=-4;n<=4;n++)for(var i=-4;i<=4;i++){var u=Math.max(Math.abs(i),Math.abs(n)),h=s+i,f=e+n;0<=h&&h<this.size&&0<=f&&f<this.size&&this.setFunctionModule(h,f,u!=2&&u!=4)}},r.prototype.drawAlignmentPattern=function(s,e){for(var n=-2;n<=2;n++)for(var i=-2;i<=2;i++)this.setFunctionModule(s+i,e+n,Math.max(Math.abs(i),Math.abs(n))!=1)},r.prototype.setFunctionModule=function(s,e,n){this.modules[e][s]=n,this.isFunction[e][s]=!0},r.prototype.addEccAndInterleave=function(s){var e=this.version,n=this.errorCorrectionLevel;if(s.length!=r.getNumDataCodewords(e,n))throw new RangeError("Invalid argument");for(var i=r.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][e],u=r.ECC_CODEWORDS_PER_BLOCK[n.ordinal][e],h=Math.floor(r.getNumRawDataModules(e)/8),f=i-h%i,v=Math.floor(h/i),p=[],m=r.reedSolomonComputeDivisor(u),_=0,P=0;_<i;_++){var k=s.slice(P,P+v-u+(_<f?0:1));P+=k.length;var y=r.reedSolomonComputeRemainder(k,m);_<f&&k.push(0),p.push(k.concat(y))}for(var L=[],A=function(B){p.forEach(function(H,S){(B!=v-u||S>=f)&&L.push(H[B])})},_=0;_<p[0].length;_++)A(_);return l(L.length==h),L},r.prototype.drawCodewords=function(s){if(s.length!=Math.floor(r.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var e=0,n=this.size-1;n>=1;n-=2){n==6&&(n=5);for(var i=0;i<this.size;i++)for(var u=0;u<2;u++){var h=n-u,f=(n+1&2)==0,v=f?this.size-1-i:i;!this.isFunction[v][h]&&e<s.length*8&&(this.modules[v][h]=a(s[e>>>3],7-(e&7)),e++)}}l(e==s.length*8)},r.prototype.applyMask=function(s){if(s<0||s>7)throw new RangeError("Mask value out of range");for(var e=0;e<this.size;e++)for(var n=0;n<this.size;n++){var i=void 0;switch(s){case 0:i=(n+e)%2==0;break;case 1:i=e%2==0;break;case 2:i=n%3==0;break;case 3:i=(n+e)%3==0;break;case 4:i=(Math.floor(n/3)+Math.floor(e/2))%2==0;break;case 5:i=n*e%2+n*e%3==0;break;case 6:i=(n*e%2+n*e%3)%2==0;break;case 7:i=((n+e)%2+n*e%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[e][n]&&i&&(this.modules[e][n]=!this.modules[e][n])}},r.prototype.getPenaltyScore=function(){for(var s=0,e=0;e<this.size;e++){for(var n=!1,i=0,u=[0,0,0,0,0,0,0],h=0;h<this.size;h++)this.modules[e][h]==n?(i++,i==5?s+=r.PENALTY_N1:i>5&&s++):(this.finderPenaltyAddHistory(i,u),n||(s+=this.finderPenaltyCountPatterns(u)*r.PENALTY_N3),n=this.modules[e][h],i=1);s+=this.finderPenaltyTerminateAndCount(n,i,u)*r.PENALTY_N3}for(var h=0;h<this.size;h++){for(var n=!1,f=0,u=[0,0,0,0,0,0,0],e=0;e<this.size;e++)this.modules[e][h]==n?(f++,f==5?s+=r.PENALTY_N1:f>5&&s++):(this.finderPenaltyAddHistory(f,u),n||(s+=this.finderPenaltyCountPatterns(u)*r.PENALTY_N3),n=this.modules[e][h],f=1);s+=this.finderPenaltyTerminateAndCount(n,f,u)*r.PENALTY_N3}for(var e=0;e<this.size-1;e++)for(var h=0;h<this.size-1;h++){var v=this.modules[e][h];v==this.modules[e][h+1]&&v==this.modules[e+1][h]&&v==this.modules[e+1][h+1]&&(s+=r.PENALTY_N2)}for(var p=0,m=0,_=this.modules;m<_.length;m++){var P=_[m];p=P.reduce(function(L,A){return L+(A?1:0)},p)}var k=this.size*this.size,y=Math.ceil(Math.abs(p*20-k*10)/k)-1;return l(0<=y&&y<=9),s+=y*r.PENALTY_N4,l(0<=s&&s<=2568888),s},r.prototype.getAlignmentPatternPositions=function(){if(this.version==1)return[];for(var s=Math.floor(this.version/7)+2,e=this.version==32?26:Math.ceil((this.version*4+4)/(s*2-2))*2,n=[6],i=this.size-7;n.length<s;i-=e)n.splice(1,0,i);return n},r.getNumRawDataModules=function(s){if(s<r.MIN_VERSION||s>r.MAX_VERSION)throw new RangeError("Version number out of range");var e=(16*s+128)*s+64;if(s>=2){var n=Math.floor(s/7)+2;e-=(25*n-10)*n-55,s>=7&&(e-=36)}return l(208<=e&&e<=29648),e},r.getNumDataCodewords=function(s,e){return Math.floor(r.getNumRawDataModules(s)/8)-r.ECC_CODEWORDS_PER_BLOCK[e.ordinal][s]*r.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][s]},r.reedSolomonComputeDivisor=function(s){if(s<1||s>255)throw new RangeError("Degree out of range");for(var e=[],n=0;n<s-1;n++)e.push(0);e.push(1);for(var i=1,n=0;n<s;n++){for(var u=0;u<e.length;u++)e[u]=r.reedSolomonMultiply(e[u],i),u+1<e.length&&(e[u]^=e[u+1]);i=r.reedSolomonMultiply(i,2)}return e},r.reedSolomonComputeRemainder=function(s,e){for(var n=e.map(function(v){return 0}),i=function(v){var p=v^n.shift();n.push(0),e.forEach(function(m,_){return n[_]^=r.reedSolomonMultiply(m,p)})},u=0,h=s;u<h.length;u++){var f=h[u];i(f)}return n},r.reedSolomonMultiply=function(s,e){if(s>>>8||e>>>8)throw new RangeError("Byte out of range");for(var n=0,i=7;i>=0;i--)n=n<<1^(n>>>7)*285,n^=(e>>>i&1)*s;return l(n>>>8==0),n},r.prototype.finderPenaltyCountPatterns=function(s){var e=s[1];l(e<=this.size*3);var n=e>0&&s[2]==e&&s[3]==e*3&&s[4]==e&&s[5]==e;return(n&&s[0]>=e*4&&s[6]>=e?1:0)+(n&&s[6]>=e*4&&s[0]>=e?1:0)},r.prototype.finderPenaltyTerminateAndCount=function(s,e,n){return s&&(this.finderPenaltyAddHistory(e,n),e=0),e+=this.size,this.finderPenaltyAddHistory(e,n),this.finderPenaltyCountPatterns(n)},r.prototype.finderPenaltyAddHistory=function(s,e){e[0]==0&&(s+=this.size),e.pop(),e.unshift(s)},r.MIN_VERSION=1,r.MAX_VERSION=40,r.PENALTY_N1=3,r.PENALTY_N2=3,r.PENALTY_N3=40,r.PENALTY_N4=10,r.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],r.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],r}();c.QrCode=t;function o(r,s,e){if(s<0||s>31||r>>>s)throw new RangeError("Value out of range");for(var n=s-1;n>=0;n--)e.push(r>>>n&1)}function a(r,s){return(r>>>s&1)!=0}function l(r){if(!r)throw new Error("Assertion error")}var d=function(){function r(s,e,n){if(this.mode=s,this.numChars=e,this.bitData=n,e<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}return r.makeBytes=function(s){for(var e=[],n=0,i=s;n<i.length;n++){var u=i[n];o(u,8,e)}return new r(r.Mode.BYTE,s.length,e)},r.makeNumeric=function(s){if(!r.isNumeric(s))throw new RangeError("String contains non-numeric characters");for(var e=[],n=0;n<s.length;){var i=Math.min(s.length-n,3);o(parseInt(s.substring(n,n+i),10),i*3+1,e),n+=i}return new r(r.Mode.NUMERIC,s.length,e)},r.makeAlphanumeric=function(s){if(!r.isAlphanumeric(s))throw new RangeError("String contains unencodable characters in alphanumeric mode");var e=[],n;for(n=0;n+2<=s.length;n+=2){var i=r.ALPHANUMERIC_CHARSET.indexOf(s.charAt(n))*45;i+=r.ALPHANUMERIC_CHARSET.indexOf(s.charAt(n+1)),o(i,11,e)}return n<s.length&&o(r.ALPHANUMERIC_CHARSET.indexOf(s.charAt(n)),6,e),new r(r.Mode.ALPHANUMERIC,s.length,e)},r.makeSegments=function(s){return s==""?[]:r.isNumeric(s)?[r.makeNumeric(s)]:r.isAlphanumeric(s)?[r.makeAlphanumeric(s)]:[r.makeBytes(r.toUtf8ByteArray(s))]},r.makeEci=function(s){var e=[];if(s<0)throw new RangeError("ECI assignment value out of range");if(s<128)o(s,8,e);else if(s<16384)o(2,2,e),o(s,14,e);else if(s<1e6)o(6,3,e),o(s,21,e);else throw new RangeError("ECI assignment value out of range");return new r(r.Mode.ECI,0,e)},r.isNumeric=function(s){return r.NUMERIC_REGEX.test(s)},r.isAlphanumeric=function(s){return r.ALPHANUMERIC_REGEX.test(s)},r.prototype.getData=function(){return this.bitData.slice()},r.getTotalBits=function(s,e){for(var n=0,i=0,u=s;i<u.length;i++){var h=u[i],f=h.mode.numCharCountBits(e);if(h.numChars>=1<<f)return 1/0;n+=4+f+h.bitData.length}return n},r.toUtf8ByteArray=function(s){s=encodeURI(s);for(var e=[],n=0;n<s.length;n++)s.charAt(n)!="%"?e.push(s.charCodeAt(n)):(e.push(parseInt(s.substring(n+1,n+3),16)),n+=2);return e},r.NUMERIC_REGEX=/^[0-9]*$/,r.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,r.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r}();c.QrSegment=d})(Et||(Et={}));(function(c){(function(t){var o=function(){function a(l,d){this.ordinal=l,this.formatBits=d}return a.LOW=new a(0,1),a.MEDIUM=new a(1,0),a.QUARTILE=new a(2,3),a.HIGH=new a(3,2),a}();t.Ecc=o})(c.QrCode||(c.QrCode={}))})(Et||(Et={}));(function(c){(function(t){var o=function(){function a(l,d){this.modeBits=l,this.numBitsCharCount=d}return a.prototype.numCharCountBits=function(l){return this.numBitsCharCount[Math.floor((l+7)/17)]},a.NUMERIC=new a(1,[10,12,14]),a.ALPHANUMERIC=new a(2,[9,11,13]),a.BYTE=new a(4,[8,16,16]),a.KANJI=new a(8,[8,10,12]),a.ECI=new a(7,[0,0,0]),a}();t.Mode=o})(c.QrSegment||(c.QrSegment={}))})(Et||(Et={}));var xt=Et,vn="H",Se={L:xt.QrCode.Ecc.LOW,M:xt.QrCode.Ecc.MEDIUM,Q:xt.QrCode.Ecc.QUARTILE,H:xt.QrCode.Ecc.HIGH},Do=function(){try{new Path2D().addPath(new Path2D)}catch(c){return!1}return!0}();function gn(c){return c in Se}function pn(c,t){t===void 0&&(t=0);var o=[];return c.forEach(function(a,l){var d=null;a.forEach(function(r,s){if(!r&&d!==null){o.push("M".concat(d+t," ").concat(l+t,"h").concat(s-d,"v1H").concat(d+t,"z")),d=null;return}if(s===a.length-1){if(!r)return;d===null?o.push("M".concat(s+t,",").concat(l+t," h1v1H").concat(s+t,"z")):o.push("M".concat(d+t,",").concat(l+t," h").concat(s+1-d,"v1H").concat(d+t,"z"));return}r&&d===null&&(d=s)})}),o.join("")}var Me={value:{type:String,required:!0,default:""},size:{type:Number,default:100},level:{type:String,default:vn,validator:function(c){return gn(c)}},background:{type:String,default:"#fff"},foreground:{type:String,default:"#000"},margin:{type:Number,required:!1,default:0}},Oo=Kt(Kt({},Me),{renderAs:{type:String,required:!1,default:"canvas",validator:function(c){return["canvas","svg"].indexOf(c)>-1}}}),Io=ft({name:"QRCodeSvg",props:Me,setup:function(c){var t=X(0),o=X(""),a=function(){var l=c.value,d=c.level,r=c.margin,s=xt.QrCode.encodeText(l,Se[d]).getModules();t.value=s.length+r*2,o.value=pn(s,r)};return a(),je(a),function(){return kt("svg",{width:c.size,height:c.size,"shape-rendering":"crispEdges",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(t.value," ").concat(t.value)},[kt("path",{fill:c.background,d:"M0,0 h".concat(t.value,"v").concat(t.value,"H0z")}),kt("path",{fill:c.foreground,d:o.value})])}}}),No=ft({name:"QRCodeCanvas",props:Me,setup:function(c){var t=X(null),o=function(){var a=c.value,l=c.level,d=c.size,r=c.margin,s=c.background,e=c.foreground,n=t.value;if(n){var i=n.getContext("2d");if(i){var u=xt.QrCode.encodeText(a,Se[l]).getModules(),h=u.length+r*2,f=window.devicePixelRatio||1,v=d/h*f;n.height=n.width=d*f,i.scale(v,v),i.fillStyle=s,i.fillRect(0,0,h,h),i.fillStyle=e,Do?i.fill(new Path2D(pn(u,r))):u.forEach(function(p,m){p.forEach(function(_,P){_&&i.fillRect(P+r,m+r,1,1)})})}}};return Xt(o),je(o),function(){return kt("canvas",{ref:t,style:{width:"".concat(c.size,"px"),height:"".concat(c.size,"px")}})}}}),Uo=ft({name:"Qrcode",render:function(){var c=this.$props,t=c.renderAs,o=c.value,a=c.size,l=c.margin,d=c.level,r=c.background,s=c.foreground,e=a>>>0,n=l>>>0,i=gn(d)?d:vn;return kt(t==="svg"?Io:No,{value:o,size:e,margin:n,level:i,background:r,foreground:s})},props:Oo});const Bo=c=>ht(void 0,null,function*(){try{return yield cn(tn.POST)("/api/sources/create",c)}catch(t){console.log("error")}}),Fo=c=>ht(void 0,null,function*(){try{return yield cn(tn.POST)("/api/uploads/create",c)}catch(t){console.log("error")}});const xe=c=>(me("data-v-50c8e8c6"),c=c(),Ce(),c),Ho={class:"btn-item"},$o={class:"blt-modal"},zo={class:"blt-modal-main"},Wo=xe(()=>G("img",{style:{width:"400px","margin-left":"20px"},src:"https://enjoyer.vueadmin.com/blt/1.png",alt:"#"},null,-1)),Yo={class:"blt-modal-text"},Go=xe(()=>G("div",null,"太棒了,恭喜你生成了一张属于你的数字艺术作品",-1)),Ko=xe(()=>G("div",null,"扫描下方二维码带走它",-1)),Xo=ft({__name:"index",setup(c){const{DownloadIcon:t,ShareIcon:o,PawIcon:a,SettingsSharpIcon:l,CreateIcon:d,Refresh:r}=rn.ionicons5,s=Ve(),e=ct(),{getPackagesList:n}=Hn();Ze(),Ao();const i=X(!1);let u=null;const h=X(!1),f=X(!0),v=X(!0),{importUploadFileListRef:p,importCustomRequest:m,importBeforeUpload:_}=Lo(),P=X(""),k=X(""),y=X(!1),L=X(6e4),A=U(()=>s.getChartToolsStatus===Oe.ASIDE),B=U(()=>s.getChartToolsStatusHide),H=U(()=>f.value&&B.value),S=U(()=>{if(!A.value)return lt;const I=[];return lt.map(Y=>{I.unshift(Y)}),I}),q=()=>{u=setTimeout(()=>{f.value&&(f.value=!1,v.value=!0)},200),setTimeout(()=>{v.value=!1},400)},b=()=>{clearTimeout(u),f.value||(f.value=!0)},D=()=>{const I=document.documentElement;I.requestFullscreen&&I.requestFullscreen(),console.log("refreshHandle"),e.setSingCanvas(""),e.emptyComponentList(),z()},R=()=>{i.value=!0},g=()=>{i.value=!1},w=I=>{if(I.indexOf("=")>0){var Y=I.indexOf("=");I=I.substring(0,Y)}return parseInt(I.length-I.length/8*2+"")},M=()=>{L.value<=0?(y.value=!1,D()):(L.value-=1e3,setTimeout(M,1e3))},x=I=>ht(this,null,function*(){try{on();const Y=["Backgrounds","Rabbits","Clothing","Informations","Other"];Ne(I.chartKey,en(I)),Ne(I.conKey,nn(I));let $=yield we(I);e.addComponentList($,!1,!0),e.setTargetSelectChart($.id),Y.includes(I.package)&&e.setLock(!0,!0),ce()}catch(Y){sn(),window.$message.warning("图表正在研发中, 敬请期待...")}}),z=()=>{const Y=e.getComponentList.map($=>$.key);Y.includes("TextGroup")||n.Informations.map($=>{$.key==="TextGroup"&&x($)}),Y.includes("TextCommon")||n.Informations.map($=>{$.key==="TextCommon"&&x($)}),Y.includes("Other1")||n.Other.map($=>{$.key==="Other1"&&x($)}),Y.includes("Other2")||n.Other.map($=>{$.key==="Other2"&&x($)})},N=()=>ht(this,null,function*(){const I=e.getComponentList,Y=I[1];Y.attr.zIndex=9e3,yield e.updateComponentList(1,Y);const $=I[0];$.attr.zIndex=9e3,yield e.updateComponentList(0,$);const vt=document.querySelector(".go-edit-range"),At=yield Pn(vt,{backgroundColor:null,allowTaint:!0,useCORS:!0}),Jt="fEFtyOAP4KqE5j0KIGK4Dg0X9xHDjMo2OnQnk4w4:TnrvaVkukV-7tDQB3RNbzvLfsXg=:eyJzY29wZSI6InRpbWVzYXBjZTIwMjMwNTA1IiwiZGVhZGxpbmUiOjE4ODMyOTY0ODR9";let ut=At.toDataURL();ut=ut.replace("data:image/png;base64,",""),ut=ut.replace("data:image/jpeg;base64,",""),ut=ut.replace("data:image/jpg;base64,",""),ut=ut.replace("data:image/gif;base64,","");const Zt="https://upload-z1.qiniup.com/putb64/"+w(ut),gt=new XMLHttpRequest,j=Ie("qrcode"),Dt=Ie("code");gt.open("POST",Zt,!0),gt.setRequestHeader("Content-Type","application/octet-stream"),gt.setRequestHeader("Authorization","UpToken "+Jt),gt.send(ut),gt.onreadystatechange=()=>ht(this,null,function*(){if(gt.readyState===4){const Pt=JSON.parse(gt.responseText).key;P.value="data:image/png;base64,"+ut,k.value="https://enjoyer.vueadmin.com/"+Pt,y.value=!0,L.value=6e4,yield Bo({generation_date:"2023-05-16 20:51",generation_terminal:"PC",image_code:Pt,par_value:"20",is_verified:!1,resource_code:Dt,qrcode:j,code:Dt}),yield Fo({device:"A",image_path:Pt}),e.setSingCanvas(""),M()}})}),lt=[{key:"refresh",type:yt.BUTTON,name:"重置",icon:r,handle:D},{key:"sign",type:yt.BUTTON,name:"签名",icon:d,handle:R},{key:"create",type:yt.BUTTON,name:"生成",icon:t,handle:N}];return(I,Y)=>{const $=dt("n-icon"),vt=dt("n-text"),At=dt("n-button"),Jt=dt("n-upload"),ut=dt("n-tooltip"),Zt=dt("n-image"),gt=dt("n-modal");return O(),at(Tt,null,[G("div",{class:pt(["go-chart-edit-tools",[E(s).getChartToolsStatus,H.value?"isMini":"unMini"]]),onClick:Y[1]||(Y[1]=j=>f.value&&(f.value=!1)),onMouseenter:q,onMouseleave:b},[Bt(K($,{class:"asideLogo",size:"22"},{default:F(()=>[K(E(a))]),_:1},512),[[Ft,E(s).getChartToolsStatus===E(Oe).ASIDE&&H.value]]),(O(!0),at(Tt,null,Rt(S.value,(j,Dt)=>(O(),Z(ut,{key:j.key+Dt,disabled:!A.value||B.value&&v.value,trigger:"hover",placement:"left"},{trigger:F(()=>[G("div",Ho,[j.type===E(yt).BUTTON?(O(),Z(At,{key:0,circle:A.value,secondary:"",onClick:j.handle},{icon:F(()=>[A.value?(O(),Z($,{key:0,size:"22"},{default:F(()=>[(O(),Z(St(j.icon)))]),_:2},1024)):(O(),Z(St(j.icon),{key:1}))]),default:F(()=>[Bt(K(vt,{depth:"3"},{default:F(()=>[zt(It(j.name),1)]),_:2},1536),[[Ft,!A.value]])]),_:2},1032,["circle","onClick"])):j.type===E(yt).IMPORTUPLOAD?(O(),Z(Jt,{key:1,"file-list":E(p),"onUpdate:fileList":Y[0]||(Y[0]=Pt=>Tn(p)?p.value=Pt:null),"show-file-list":!1,customRequest:E(m),onBeforeUpload:E(_)},{default:F(()=>[K(At,{circle:A.value,secondary:""},{icon:F(()=>[A.value?(O(),Z($,{key:0,size:"22"},{default:F(()=>[(O(),Z(St(j.icon)))]),_:2},1024)):(O(),Z(St(j.icon),{key:1}))]),default:F(()=>[Bt(K(vt,{depth:"3"},{default:F(()=>[zt(It(j.name),1)]),_:2},1536),[[Ft,!A.value]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):Vt("",!0)])]),default:F(()=>[G("span",null,It(j.name),1)]),_:2},1032,["disabled"]))),128)),K(gt,{show:y.value},{default:F(()=>[G("div",$o,[G("div",zo,[K(Zt,{width:"700",height:"350",src:P.value},null,8,["src"]),Wo]),G("div",Yo,[Go,Ko,G("div",null,"解锁倒计时："+It(L.value/1e3),1)]),K(Uo,{class:"blt-group-qrcode",value:k.value,size:150,level:"H"},null,8,["value"])])]),_:1},8,["show"])],34),K(E(Bn),{modelShow:h.value,"onUpdate:modelShow":Y[2]||(Y[2]=j=>h.value=j)},null,8,["modelShow"]),K(E(To),{modalShow:i.value,onClose:g},null,8,["modalShow"])],64)}}}),Qo=Ct(Xo,[["__scopeId","data-v-50c8e8c6"]]);const qo=c=>(me("data-v-1f4f1a65"),c=c(),Ce(),c),Vo=qo(()=>G("img",{src:"https://enjoyer.vueadmin.com/blt/2.png",style:{width:"800px","margin-bottom":"20px"}},null,-1)),Jo=ft({__name:"index",setup(c){const{GO_CHART_LAYOUT_STORE:t}=kn,o=ct(),{handleContextMenu:a}=_e();X(""),bn(In,null),$n();const{mouseenterHandle:l,mouseleaveHandle:d,mousedownHandle:r,mouseClickHandle:s,touchstartHandle:e}=Ee(),n=(f,v,p)=>{if(o.getTargetChart.selectId.length>1)return v.filter(_=>[T.GROUP,T.DELETE].includes(_.key));const m=[];return p.status.lock?m.push(T.LOCK):m.push(T.UNLOCK),p.status.hide?m.push(T.HIDE):m.push(T.SHOW),f.filter(_=>!m.includes(_.key))},i=U(()=>o.getEditCanvasConfig.chartThemeSetting),u=U(()=>Qe(o.getEditCanvasConfig.chartCustomThemeColorInfo)[o.getEditCanvasConfig.chartThemeColor]);U(()=>o.getEditCanvasConfig.filterShow);const h=U(()=>({width:"inherit",height:"inherit"}));return Xt(()=>{Kn(),Ln(t,{layers:!1,charts:!0,details:!0,chartType:"double",layerType:"thumbnail",percentage:0,rePositionCanvas:!0})}),(f,v)=>(O(),Z(E(Un),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:E(ln),onDrop:E(Xn),onDragover:E(Fe),onDragenter:E(Fe)},{aside:F(()=>[K(E(Qo))]),default:F(()=>[K(E(_o),null,{default:F(()=>[Vo,G("div",{id:"go-chart-edit-content",onContextmenu:v[0]||(v[0]=(...p)=>E(a)&&E(a)(...p))},[K(E(uo),null,{default:F(()=>[G("div",{class:"content-edit-range",style:it(W(W({},E($t)(E(o).getEditCanvasConfig)),h.value))},[(O(!0),at(Tt,null,Rt(E(o).getComponentList,(p,m)=>(O(),at("div",{key:p.id},[p.isGroup?(O(),Z(E(to),{key:0,groupData:p,groupIndex:m},null,8,["groupData","groupIndex"])):(O(),Z(E(de),{key:1,"data-id":p.id,index:m,style:it(W(W({},E(Wt)(p.attr,m)),E(qe)(p.styles))),item:p,onClick:_=>E(s)(_,p),onMousedown:_=>E(r)(_,p),onMouseenter:_=>E(l)(_,p),onMouseleave:_=>E(d)(_,p),onContextmenu:_=>E(a)(_,p,n),onTouchstart:_=>E(e)(_,p)},{default:F(()=>[(O(),Z(St(p.chartConfig.chartKey),{class:pt(["edit-content-chart",E(re)(p.styles.animations)]),chartConfig:p,themeSetting:i.value,themeColor:u.value,style:it(W(W(W({},E(wt)(p.attr)),E($t)(p.styles)),E(ie)(p.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu","onTouchstart"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}}),Es=Ct(Jo,[["__scopeId","data-v-1f4f1a65"]]);export{Es as default};

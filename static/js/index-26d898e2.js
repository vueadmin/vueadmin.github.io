var J=Object.defineProperty;var j=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var N=(a,s,t)=>s in a?J(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,E=(a,s)=>{for(var t in s||(s={}))K.call(s,t)&&N(a,t,s[t]);if(j)for(var t of j(s))Q.call(s,t)&&N(a,t,s[t]);return a};var D=(a,s,t)=>new Promise((I,w)=>{var m=l=>{try{f(t.next(l))}catch(v){w(v)}},R=l=>{try{f(t.throw(l))}catch(v){w(v)}},f=l=>l.done?I(l.value):Promise.resolve(l.value).then(m,R);f((t=t.apply(a,s)).next())});import{d as X,j as A,ab as V,B as Z,bb as ee,a1 as te,a as _,o as S,c as $,b as o,w as e,F as z,q as oe,D as F,E as se,n as ne,t as k,u as L,e as h,aO as ae,R as re,ac as ce,Y as b,M as ie,bc as le,an as de,ao as C,aL as x,N as pe,h as ue}from"./index-20fb0306.js";import{u as _e}from"./index-e3d67d15.js";import{u as me,P as fe}from"./chartEditStore-eb4e0443.js";import{s as ve}from"./useSyncUpdate.hook-6a50f8e1.js";import{a as ye}from"./project.api-bcdd5979.js";import{i as he}from"./icon-cb727678.js";import{l as we}from"./lodash-819dc23a.js";import"./plugin-2033e7b2.js";import"./useSync.hook-b03903fa.js";import"./chartLayoutStore-b4f2137a.js";import"./index-63f16b81.js";import"./SettingItem-11e342fe.js";/* empty css                                                                      */import"./SettingItemBox-6e9bb9c5.js";import"./CollapseItem.vue_vue_type_script_setup_true_lang-561b5bfa.js";import"./chart-169a825c.js";const ge=h("发布管理"),Ee=h(" 复制地址 "),Se=h("关闭弹窗"),Ce=X({__name:"index",setup(a){const{BrowsersOutlineIcon:s,SendIcon:t,AnalyticsIcon:I,CloseIcon:w}=he.ionicons5,m=me(),R=A(V()),{copy:f,isSupported:l}=_e({source:R}),v=Z(),y=A(!1),p=A(!1);ee(()=>{p.value=m.getProjectInfo.release||!1});const H=()=>{y.value=!1},M=()=>{const n=ie(le.CHART_PREVIEW_NAME,"href");if(!n)return;const{id:r}=v.params,c=typeof r=="string"?r:r[0],d=m.getStorageInfo(),i=de(C.GO_CHART_STORAGE_LIST)||[];if(i!=null&&i.length){const g=i.findIndex(T=>T.id===c);g!==-1?(i.splice(g,1,E({id:c},d)),x(C.GO_CHART_STORAGE_LIST,i)):(i.push(E({id:c},d)),x(C.GO_CHART_STORAGE_LIST,i))}else x(C.GO_CHART_STORAGE_LIST,[E({id:c},d)]);pe(n,[c],void 0,!0)},P=()=>{y.value=!y.value},O=(n,r)=>{l?(f(),window.$message.success(n||"复制成功！")):window.$message.error(r||"复制失败！")},U=()=>D(this,null,function*(){const n=yield ye({id:ae(),state:p.value?-1:1});n&&n.code===re.SUCCESS?(P(),p.value?window.$message.success("已取消发布"):O("发布成功！已复制地址到剪贴板~","发布成功！"),m.setProjectInfo(fe.RELEASE,!p.value)):ce()}),B=[{select:!0,title:()=>"同步内容",type:()=>"primary",icon:b(I),event:ve},{key:"preview",title:()=>"预览",type:()=>"default",icon:b(s),event:M},{key:"release",title:()=>p.value?"已发布":"发布",icon:b(t),type:()=>p.value?"primary":"default",event:P}],q=te(()=>{if(m.getEditCanvas.isCodeEdit)return B;const n=we.cloneDeep(B);return n.shift(),n});return(n,r)=>{const c=_("n-button"),d=_("n-space"),i=_("n-h3"),g=_("n-icon"),T=_("n-alert"),G=_("n-list-item"),W=_("n-list"),Y=_("n-modal");return S(),$(z,null,[o(d,{class:"go-mt-0"},{default:e(()=>[(S(!0),$(z,null,oe(L(q),u=>(S(),F(c,{key:u.key,type:u.type(),ghost:"",onClick:u.event},{icon:e(()=>[(S(),F(se(u.icon)))]),default:e(()=>[ne("span",null,k(u.title()),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),o(Y,{show:y.value,"onUpdate:show":r[1]||(r[1]=u=>y.value=u),onAfterLeave:H},{default:e(()=>[o(W,{bordered:"",class:"go-system-setting"},{header:e(()=>[o(d,{justify:"space-between"},{default:e(()=>[o(i,{class:"go-mb-0"},{default:e(()=>[ge]),_:1}),o(g,{size:"20",class:"go-cursor-pointer",onClick:H},{default:e(()=>[o(L(w))]),_:1})]),_:1})]),default:e(()=>[o(G,null,{default:e(()=>[o(d,{size:10},{default:e(()=>[o(T,{"show-icon":!1,title:"预览地址：",type:"success"},{default:e(()=>[h(k(L(V)()),1)]),_:1}),o(d,{vertical:""},{default:e(()=>[o(c,{tertiary:"",type:"primary",onClick:r[0]||(r[0]=u=>O())},{default:e(()=>[Ee]),_:1}),o(c,{type:p.value?"warning":"primary",onClick:U},{default:e(()=>[h(k(p.value?"取消发布":"发布大屏"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),o(G,null,{default:e(()=>[o(d,{size:10},{default:e(()=>[o(c,{onClick:P},{default:e(()=>[Se]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])],64)}}});const $e=ue(Ce,[["__scopeId","data-v-d4d41241"]]);export{$e as default};

var O=(e,a,s)=>new Promise((u,h)=>{var w=t=>{try{f(s.next(t))}catch(c){h(c)}},d=t=>{try{f(s.throw(t))}catch(c){h(c)}},f=t=>t.done?u(t.value):Promise.resolve(t.value).then(w,d);f((s=s.apply(e,a)).next())});import{d as U,a1 as Y,o as i,c as D,F as R,q as A,u as l,a as r,a5 as G,a6 as ce,b as n,w as o,D as y,E,a7 as T,h as q,l as V,H as $,Y as j,j as B,n as k,e as M,t as N,a8 as ie,a9 as ee,J as re,M as de,I as _e,N as ue,aa as pe,ab as me,ac as F,R as K,Q as X,U as Z}from"./index-20fb0306.js";import{i as J}from"./icon-cb727678.js";import{p as ge,d as fe,a as ve}from"./project.api-bcdd5979.js";import{g as he,D as be}from"./plugin-2033e7b2.js";const we={class:"go-apple-control-btn"},ye=["onClick"],ke=U({__name:"index",props:{mini:{request:!1,type:Boolean,default:!1},disabled:{request:!1,type:Boolean,default:!1},hidden:{request:!1,type:Array,default(){return[]}},narrow:{request:!1,type:Boolean,default:!1}},emits:["close","remove","resize","fullResize"],setup(e,{emit:a}){const s=e,{CloseIcon:u,RemoveIcon:h,ResizeIcon:w}=J.ionicons5,d=Y(()=>t.filter(v=>s.hidden.findIndex(_=>v.key==_)===-1)),f=Y(()=>s.narrow&&T(!0)),t=[{title:"关闭",key:"close",icon:u},{title:"缩小",key:"remove",icon:h},{title:f.value?"缩小":"放大",key:s.narrow?"fullResize":"resize",icon:w}],c=m=>{m==="fullResize"&&T(),m==="remove"&&T(!0)&&T(),a(m)};return(m,v)=>{const _=r("n-icon");return i(),D("div",we,[(i(!0),D(R,null,A(l(d),b=>(i(),D("div",{key:b.key,class:G(["btn",[b.key,e.disabled&&"disabled",e.mini&&"mini"]]),onClick:ce(x=>c(b.key),["stop"])},[n(_,{size:"10",class:G(["icon-base",{hover:!e.disabled}])},{default:o(()=>[(i(),y(E(b.icon)))]),_:2},1032,["class"])],10,ye))),128))])}}});const te=q(ke,[["__scopeId","data-v-281e8a22"]]),De={key:0,class:"go-items-list-card"},xe={class:"list-content"},ze={class:"list-content-top"},Ce={class:"go-flex-items-center list-footer",justify:"space-between"},$e={class:"go-flex-items-center list-footer-ri"},Ie=U({__name:"index",props:{cardData:Object},emits:["preview","delete","resize","edit","release"],setup(e,{emit:a}){var p;const s=e,{EllipsisHorizontalCircleSharpIcon:u,CopyIcon:h,TrashIcon:w,PencilIcon:d,DownloadIcon:f,BrowsersOutlineIcon:t,HammerIcon:c,SendIcon:m}=J.ionicons5,v=V([{label:$("global.r_edit"),key:"edit",icon:j(c)},{lable:$("global.r_more"),key:"select",icon:j(u)}]),_=B([{label:$("global.r_preview"),key:"preview",icon:j(t)},{label:(p=s.cardData)!=null&&p.release?$("global.r_unpublish"):$("global.r_publish"),key:"release",icon:j(m)},{label:$("global.r_delete"),key:"delete",icon:j(w)}]),b=g=>{switch(g){case"preview":x();break;case"delete":z();break;case"release":P();break;case"edit":C();break}},x=()=>{a("preview",s.cardData)},z=()=>{a("delete",s.cardData)},C=()=>{a("edit",s.cardData)},P=()=>{a("release",s.cardData)},I=()=>{a("resize",s.cardData)};return(g,L)=>{const H=r("n-image"),Q=r("n-text"),ne=r("n-badge"),W=r("n-button"),ae=r("n-dropdown"),oe=r("n-tooltip"),se=r("n-space"),le=r("n-card");return e.cardData?(i(),D("div",De,[n(le,{hoverable:"",size:"small"},{action:o(()=>[k("div",Ce,[n(Q,{class:"go-ellipsis-1"},{default:o(()=>[M(N(e.cardData.title||e.cardData.id||"未命名"),1)]),_:1}),k("div",$e,[n(se,null,{default:o(()=>[n(Q,null,{default:o(()=>[n(ne,{class:"go-animation-twinkle",dot:"",color:e.cardData.release?"#34c749":"#fcbc40"},null,8,["color"]),M(" "+N(e.cardData.release?g.$t("project.release"):g.$t("project.unreleased")),1)]),_:1}),(i(!0),D(R,null,A(v,S=>(i(),D(R,{key:S.key},[S.key==="select"?(i(),y(ae,{key:0,trigger:"hover",placement:"bottom",options:_.value,"show-arrow":!0,onSelect:b},{default:o(()=>[n(W,{size:"small"},{icon:o(()=>[(i(),y(E(S.icon)))]),_:2},1024)]),_:2},1032,["options"])):(i(),y(oe,{key:1,placement:"bottom",trigger:"hover"},{trigger:o(()=>[n(W,{size:"small",onClick:Oe=>b(S.key)},{icon:o(()=>[(i(),y(E(S.icon)))]),_:2},1032,["onClick"])]),default:o(()=>[(i(),y(E(S.label)))]),_:2},1024))],64))),128))]),_:1})])])]),default:o(()=>[k("div",xe,[k("div",ze,[n(l(te),{class:"top-btn",hidden:["remove"],onClose:z,onResize:I})]),k("div",{class:"list-content-img",onClick:I},[n(H,{"object-fit":"contain",height:"180","preview-disabled":"",src:`${e.cardData.image}?time=${new Date().getTime()}`,alt:e.cardData.title,"fallback-src":l(ie)()},null,8,["src","alt","fallback-src"])])])]),_:1})])):ee("",!0)}}});const He=q(Ie,[["__scopeId","data-v-0814e2b8"]]),Se={class:"list-content"},je={class:"list-content-img"},Ee=["src","alt"],Re=U({__name:"index",props:{modalShow:{required:!0,type:Boolean},cardData:{required:!0,type:Object}},emits:["close","edit"],setup(e,{emit:a}){const s=e,{HammerIcon:u}=J.ionicons5,h=B(!1);re(()=>s.modalShow,c=>{h.value=c},{immediate:!0});const w=V([{label:$("global.r_edit"),key:"edit",icon:j(u)}]),d=c=>{switch(c){case"edit":f();break}},f=()=>{a("edit",s.cardData)},t=()=>{a("close")};return(c,m)=>{const v=r("n-text"),_=r("n-space"),b=r("n-time"),x=r("n-badge"),z=r("n-button"),C=r("n-tooltip"),P=r("n-card"),I=r("n-modal");return i(),y(I,{class:"go-modal-box",show:h.value,"onUpdate:show":m[0]||(m[0]=p=>h.value=p),onAfterLeave:t},{default:o(()=>[n(P,{hoverable:"",size:"small"},{action:o(()=>[n(_,{class:"list-footer",justify:"space-between"},{default:o(()=>[n(v,{depth:"3"},{default:o(()=>[M(N(c.$t("project.last_edit"))+": ",1),n(b,{time:new Date,format:"yyyy-MM-dd hh:mm"},null,8,["time"])]),_:1}),n(_,null,{default:o(()=>[n(v,null,{default:o(()=>{var p,g;return[n(x,{class:"go-animation-twinkle",dot:"",color:(p=e.cardData)!=null&&p.release?"#34c749":"#fcbc40"},null,8,["color"]),M(" "+N((g=e.cardData)!=null&&g.release?c.$t("project.release"):c.$t("project.unreleased")),1)]}),_:1}),(i(!0),D(R,null,A(w,p=>(i(),y(C,{key:p.key,placement:"bottom",trigger:"hover"},{trigger:o(()=>[n(z,{size:"small",onClick:g=>d(p.key)},{icon:o(()=>[(i(),y(E(p.icon)))]),_:2},1032,["onClick"])]),default:o(()=>[(i(),y(E(p.label)))]),_:2},1024))),128))]),_:1})]),_:1})]),default:o(()=>{var p,g;return[k("div",Se,[n(_,{class:"list-content-top go-px-0",justify:"center"},{default:o(()=>[n(_,null,{default:o(()=>[n(v,null,{default:o(()=>{var L,H;return[M(N(((L=e.cardData)==null?void 0:L.title)||((H=e.cardData)==null?void 0:H.id)||"未命名"),1)]}),_:1})]),_:1})]),_:1}),n(_,{class:"list-content-top"},{default:o(()=>[n(l(te),{narrow:!0,hidden:["close"],onRemove:t})]),_:1}),k("div",je,[k("img",{src:(p=e.cardData)==null?void 0:p.image,alt:(g=e.cardData)==null?void 0:g.title},null,8,Ee)])])]}),_:1})]),_:1},8,["show"])}}});const Be=q(Re,[["__scopeId","data-v-0b024926"]]),Pe=()=>{const e=B(!1),a=B(null);return{modalData:a,modalShow:e,closeModal:()=>{e.value=!1,a.value=null},resizeHandle:d=>{d&&(e.value=!0,a.value=d)},editHandle:d=>{if(!d)return;const f=de(_e.CHART_HOME_NAME,"href");ue(f,[d.id],void 0,!0)},previewHandle:d=>{pe(me(d.id))}}},Le=()=>{const e=B(!0),a=V({page:1,limit:12,count:10}),s=B([]),u=()=>O(void 0,null,function*(){e.value=!0;const t=yield ge({page:a.page,limit:a.limit});if(t&&t.data){const{count:c}=t;a.count=c,s.value=t.data.map(m=>{const{id:v,projectName:_,state:b,createTime:x,indexImage:z,createUserId:C}=m;return{id:v,title:_,createId:C,time:x,image:z,release:b!==-1}}),setTimeout(()=>{e.value=!1},500);return}F()}),h=t=>{a.page=t,u()},w=t=>{a.limit=t,u()},d=t=>{he({type:be.DELETE,promise:!0,onPositiveCallback:()=>new Promise(c=>{c(fe({ids:t.id}))}),promiseResCallback:c=>{if(c.code===K.SUCCESS){window.$message.success(window.$t("global.r_delete_success")),u();return}F()}})},f=(t,c)=>O(void 0,null,function*(){const{id:m,release:v}=t,_=yield ve({id:m,state:v?-1:1});if(_&&_.code===K.SUCCESS){if(s.value=[],u(),v){window.$message.success(window.$t("global.r_unpublish_success"));return}window.$message.success(window.$t("global.r_publish_success"));return}F()});return u(),{loading:e,paginat:a,list:s,fetchList:u,releaseHandle:f,changeSize:w,changePage:h,deleteHandle:d}},Me={class:"go-items-list"},Ne={class:"list-pagination"},Ue=U({__name:"index",setup(e){const{modalData:a,modalShow:s,closeModal:u,previewHandle:h,resizeHandle:w,editHandle:d}=Pe(),{loading:f,paginat:t,list:c,changeSize:m,changePage:v,releaseHandle:_,deleteHandle:b}=Le();return(x,z)=>{const C=r("go-loading"),P=r("n-grid-item"),I=r("n-grid"),p=r("n-pagination");return i(),D(R,null,[k("div",Me,[X(k("div",null,[n(C)],512),[[Z,l(f)]]),X(k("div",null,[n(I,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:4 xl:4 xxl:4",responsive:"screen"},{default:o(()=>[(i(!0),D(R,null,A(l(c),(g,L)=>(i(),y(P,{key:g.id},{default:o(()=>[n(l(He),{cardData:g,onPreview:l(h),onResize:l(w),onDelete:H=>l(b)(g),onRelease:H=>l(_)(g,L),onEdit:l(d)},null,8,["cardData","onPreview","onResize","onDelete","onRelease","onEdit"])]),_:2},1024))),128))]),_:1})],512),[[Z,!l(f)]]),k("div",Ne,[n(p,{page:l(t).page,"page-size":l(t).limit,"item-count":l(t).count,"page-sizes":[12,24,36,48],"onUpdate:page":l(v),"onUpdate:pageSize":l(m),"show-size-picker":""},null,8,["page","page-size","item-count","onUpdate:page","onUpdate:pageSize"])])]),l(a)?(i(),y(l(Be),{key:0,modalShow:l(s),cardData:l(a),onClose:l(u),onEdit:l(d)},null,8,["modalShow","cardData","onClose","onEdit"])):ee("",!0)],64)}}});const qe=q(Ue,[["__scopeId","data-v-c7933e27"]]),Te={class:"go-project-items"},Ae=U({__name:"index",setup(e){return(a,s)=>(i(),D("div",Te,[n(l(qe))]))}});const Ye=q(Ae,[["__scopeId","data-v-ba0e1d55"]]);export{Ye as default};
